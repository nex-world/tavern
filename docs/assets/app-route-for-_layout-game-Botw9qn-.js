const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-libs-for-silly-tavern-BlnpFFoU.js","assets/react-DaZ__F27.js","assets/index-DqGtKwPN.js","assets/@tanstack-C_3cnQY1.js","assets/vendor-BQm4HbnU.js","assets/dexie-CAotVj7m.js","assets/app-components-yELpvzhY.js","assets/icons-5wLx_9_I.js","assets/app-hooks-BmOl9kt8.js","assets/id-OxPLOBIU.js","assets/future-lib-llm-ui-react-D9liEJay.js","assets/es-toolkit-CstbrnlE.js","assets/app-lib-BcoYN-8Y.js","assets/components-and-styling-lnR2ABT4.js","assets/@tailwind-COJ8Fh6m.js","assets/zod-grrOrvCS.js","assets/app-libs-for-custom-theme-DsXgSMAg.js","assets/gsap-DDlvirwQ.js","assets/app-components-DvwNuPEv.css","assets/@radix-ui-BQCqNqg0.js","assets/immer-BCQU3qJI.js","assets/app-styles-CSKMBz4t.css"])))=>i.map(i=>d[i]);
import { _ as h, D as he } from "./index-DqGtKwPN.js";
import { g as u, l as g, r as pe, L as _, O as A, e as N, h as ue, i as y, f as xe, N as ge, j as je } from "./@tanstack-C_3cnQY1.js";
import { j as e, r as j, t as i } from "./react-DaZ__F27.js";
import { f as L, U as X, H as Y, g as fe, a as q, h as Z, M as ve, i as ee, P as se, D as P, j as B, k as _e, F as ye, E as te, l as J, m as ae, n as ne, o as Ne } from "./icons-5wLx_9_I.js";
import { S as be, a as E, C as $, m as f, b as oe, c as Ce, E as we, I as re, d as $e, e as ce, f as Se, g as Ie, h as le, i as Pe, j as Oe, k as ke, l as De, n as ze, o as Re, p as Te } from "./app-libs-for-silly-tavern-BlnpFFoU.js";
import { y as G, z as H, A as w, C as O, E as k, F as D, G as z, H as R, S as Ae, J as Le, B as m, K as Ee, L as I, f as W, N as Me, O as Fe, P as M, Q as F, R as V, U as Ve, V as Q, W as b, X as Ue, Y as Be, Z as Ge, _ as He, $ as qe, a0 as Je, a1 as We, a2 as Qe, a3 as Ke, d as U, a4 as T } from "./app-components-yELpvzhY.js";
import { n as ie } from "./id-OxPLOBIU.js";
import { C as Xe } from "./future-lib-llm-ui-react-D9liEJay.js";
import { a as Ye } from "./app-lib-BcoYN-8Y.js";
let jt, ft, vt, _t, yt, Nt, bt, Ct, wt, K, $t, St, It, Pt, Ot, kt, xs, js, vs, ys;
let __tla = (async () => {
  let Ze, es, ss, ts, as, ns, os, rs, cs, ls, is, ds, ms, hs, ps, us, gs, fs, _s, Ns, bs;
  Ze = () => h(() => Promise.resolve().then(() => bs), void 0);
  jt = u("/_layout-game")({
    component: g(Ze, "component")
  });
  es = () => h(() => Promise.resolve().then(() => ws), void 0);
  ft = u("/_layout-game/_silly-tavern")({
    head: () => ({
      meta: [
        {
          title: "SillyTavern Lite | AI \u89D2\u8272\u626E\u6F14\u5E73\u53F0"
        },
        {
          name: "description",
          content: "\u8F7B\u91CF\u7EA7 AI \u89D2\u8272\u626E\u6F14\u5E73\u53F0\uFF0C\u652F\u6301\u89D2\u8272\u5361\u521B\u5EFA\u3001\u6311\u6218\u8BBE\u5B9A\u548C\u5BF9\u8BDD\u4F1A\u8BDD\u7BA1\u7406"
        }
      ]
    }),
    component: g(es, "component")
  });
  ss = () => h(() => Promise.resolve().then(() => Ss), void 0);
  vt = u("/_layout-game/_silly-tavern/")({
    head: () => ({
      meta: [
        {
          title: "\u6B22\u8FCE\u6765\u5230 SillyTavern Lite | Welcome to SillyTavern Lite"
        },
        {
          name: "description",
          content: "\u6B22\u8FCE\u4F7F\u7528 SillyTavern Lite\uFF0CAI \u89D2\u8272\u626E\u6F14\u521B\u4F5C\u5E73\u53F0"
        }
      ]
    }),
    component: g(ss, "component")
  });
  ts = () => h(() => Promise.resolve().then(() => Ps), void 0);
  _t = u("/_layout-game/_silly-tavern/session")({
    head: () => ({
      meta: [
        {
          title: "\u5BF9\u8BDD\u4F1A\u8BDD | Chat Sessions"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u4F60\u7684 AI \u89D2\u8272\u626E\u6F14\u5BF9\u8BDD\u4F1A\u8BDD\uFF0C\u67E5\u770B\u5386\u53F2\u8BB0\u5F55\u548C\u7EE7\u7EED\u5BF9\u8BDD"
        }
      ]
    }),
    component: g(ts, "component")
  });
  as = () => h(() => Promise.resolve().then(() => ks), void 0);
  yt = u("/_layout-game/_silly-tavern/plaza")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5E7F\u573A | Character Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u89D2\u8272\u5361\u4E0E\u6311\u6218\u5361\uFF0C\u5F00\u59CB\u4F60\u7684 AI \u89D2\u8272\u626E\u6F14\u5192\u9669"
        }
      ]
    }),
    component: g(as, "component")
  });
  ns = () => h(() => Promise.resolve().then(() => zs), void 0);
  Nt = u("/_layout-game/_silly-tavern/create")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u4F5C\u8005\u5DE5\u574A | Creator Workshop"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u548C\u7BA1\u7406\u4F60\u7684\u89D2\u8272\u5361\u4E0E\u6311\u6218\u8BBE\u5B9A\uFF0C\u6253\u9020\u72EC\u7279\u7684 AI \u89D2\u8272\u626E\u6F14\u4F53\u9A8C"
        }
      ]
    }),
    component: g(ns, "component")
  });
  os = () => h(() => Promise.resolve().then(() => Ts), void 0);
  bt = u("/_layout-game/_silly-tavern/config")({
    head: () => ({
      meta: [
        {
          title: "\u914D\u7F6E\u7BA1\u7406 | Configuration"
        },
        {
          name: "description",
          content: "\u5E94\u7528\u914D\u7F6E\u7BA1\u7406\u4E2D\u5FC3\uFF0C\u5305\u62EC LLM \u914D\u7F6E\u3001\u7CFB\u7EDF\u8BBE\u7F6E\u7B49"
        }
      ]
    }),
    component: g(os, "component")
  });
  Ct = u("/_layout-game/_silly-tavern/plaza/")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5E7F\u573A | Character Plaza"
        },
        {
          name: "description",
          content: "SillyTavern \u89D2\u8272\u5E7F\u573A\uFF0C\u6D4F\u89C8\u89D2\u8272\u5361\u548C\u6311\u6218\u5361"
        }
      ]
    }),
    beforeLoad: () => {
      throw pe({
        to: "/plaza/characters"
      });
    }
  });
  rs = () => h(() => Promise.resolve().then(() => Ls), void 0);
  wt = u("/_layout-game/_silly-tavern/config/")({
    component: g(rs, "component")
  });
  cs = () => h(() => Promise.resolve().then(() => Vs), void 0);
  K = u("/_layout-game/_silly-tavern/session/$sessionId")({
    head: () => ({
      meta: [
        {
          title: "\u5BF9\u8BDD\u4F1A\u8BDD | Chat Session"
        },
        {
          name: "description",
          content: "\u4E0E AI \u89D2\u8272\u8FDB\u884C\u5BF9\u8BDD\u4F1A\u8BDD\uFF0C\u4F53\u9A8C\u89D2\u8272\u626E\u6F14\u4E92\u52A8"
        }
      ]
    }),
    component: g(cs, "component")
  });
  ls = () => h(() => Promise.resolve().then(() => Bs), void 0);
  $t = u("/_layout-game/_silly-tavern/plaza/characters")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5361\u5E7F\u573A | Character Cards Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u89D2\u8272\u5361\uFF0C\u4E0E AI \u89D2\u8272\u5F00\u59CB\u5BF9\u8BDD\u548C\u89D2\u8272\u626E\u6F14"
        }
      ]
    }),
    component: g(ls, "component")
  });
  is = () => h(() => Promise.resolve().then(() => Hs), void 0);
  St = u("/_layout-game/_silly-tavern/plaza/challenges")({
    head: () => ({
      meta: [
        {
          title: "\u6311\u6218\u5361\u5E7F\u573A | Challenge Cards Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u6311\u6218\u5361\uFF0C\u4F53\u9A8C\u4E0D\u540C\u7684 AI \u89D2\u8272\u626E\u6F14\u6311\u6218\u6A21\u5F0F"
        }
      ]
    }),
    component: g(is, "component")
  });
  ds = () => h(() => Promise.resolve().then(() => Js), void 0);
  It = u("/_layout-game/_silly-tavern/create_/character")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA\u89D2\u8272\u5361 | Create Character Card"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u65B0\u7684 AI \u89D2\u8272\u5361\uFF0C\u5B9A\u4E49\u4EBA\u683C\u3001\u80CC\u666F\u548C\u5BF9\u8BDD\u98CE\u683C"
        }
      ]
    }),
    component: g(ds, "component")
  });
  ms = () => h(() => Promise.resolve().then(() => Qs), void 0);
  Pt = u("/_layout-game/_silly-tavern/create_/challenge")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA\u6311\u6218\u5361 | Create Challenge Card"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u65B0\u7684\u6311\u6218\u5361\uFF0C\u8BBE\u5B9A\u4E16\u754C\u53D8\u91CF\u3001\u6210\u5C31\u76EE\u6807\u548C DM \u5F15\u5BFC\u89C4\u5219"
        }
      ]
    }),
    component: g(ms, "component")
  });
  hs = () => h(() => Promise.resolve().then(() => Xs), void 0);
  Ot = u("/_layout-game/_silly-tavern/config/settings")({
    head: () => ({
      meta: [
        {
          title: "\u5E94\u7528\u8BBE\u7F6E | Application Settings"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u5E94\u7528\u7684\u57FA\u672C\u914D\u7F6E\u3001\u504F\u597D\u8BBE\u7F6E\u548C\u7528\u6237\u9009\u9879"
        }
      ]
    }),
    component: g(hs, "component")
  });
  ps = () => h(() => Promise.resolve().then(() => Zs), void 0);
  kt = u("/_layout-game/_silly-tavern/config/overview")({
    head: () => ({
      meta: [
        {
          title: "\u914D\u7F6E\u7BA1\u7406\u6982\u89C8 | Configuration Overview"
        },
        {
          name: "description",
          content: "\u914D\u7F6E\u7BA1\u7406\u4E2D\u5FC3\u6982\u89C8\uFF0C\u5C55\u793A\u6240\u6709\u53EF\u914D\u7F6E\u7684\u9879\u76EE\u548C\u8BBE\u7F6E"
        }
      ]
    }),
    component: g(ps, "component")
  });
  us = () => h(() => Promise.resolve().then(() => st), void 0);
  xs = u("/_layout-game/_silly-tavern/config/llm")({
    head: () => ({
      meta: [
        {
          title: "LLM \u914D\u7F6E | LLM Configuration"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u5927\u8BED\u8A00\u6A21\u578B\u914D\u7F6E\uFF0C\u5305\u62EC API \u5BC6\u94A5\u3001\u6A21\u578B\u9009\u62E9\u548C\u8C03\u7528\u53C2\u6570"
        }
      ]
    }),
    component: g(us, "component")
  });
  gs = () => h(() => Promise.resolve().then(() => at), void 0);
  js = u("/_layout-game/_silly-tavern/characters_/$characterId")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u8BE6\u60C5 | Character Details"
        },
        {
          name: "description",
          content: "\u67E5\u770B\u89D2\u8272\u5361\u8BE6\u60C5\u3001\u4F1A\u8BDD\u5386\u53F2\u548C\u7BA1\u7406\u89D2\u8272\u8BBE\u7F6E"
        }
      ]
    }),
    component: g(gs, "component")
  });
  fs = () => h(() => Promise.resolve().then(() => ot), void 0);
  vs = u("/_layout-game/_silly-tavern/challenges_/$challengeId")({
    head: () => ({
      meta: [
        {
          title: "\u6311\u6218\u8BE6\u60C5 | Challenge Details"
        },
        {
          name: "description",
          content: "\u67E5\u770B\u6311\u6218\u5361\u8BE6\u60C5\u3001\u89C4\u5219\u8BBE\u7F6E\u548C\u76F8\u5173\u4F1A\u8BDD\u8BB0\u5F55"
        }
      ]
    }),
    component: g(fs, "component")
  });
  _s = () => h(() => Promise.resolve().then(() => ct), void 0);
  ys = u("/_layout-game/_silly-tavern/characters_/$characterId_/edit")({
    head: () => ({
      meta: [
        {
          title: "\u7F16\u8F91\u89D2\u8272\u5361 | Edit Character Card"
        },
        {
          name: "description",
          content: "\u7F16\u8F91\u73B0\u6709\u89D2\u8272\u5361\u7684\u5C5E\u6027\u3001\u80CC\u666F\u548C\u5BF9\u8BDD\u8BBE\u7F6E"
        }
      ]
    }),
    component: g(_s, "component")
  });
  Ns = he;
  bs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ns
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Cs() {
    return e.jsxs("div", {
      className: "flex flex-col h-full overflow-hidden",
      children: [
        e.jsx("header", {
          className: "h-14 border-b bg-background flex items-center px-4 justify-between shrink-0",
          children: e.jsxs("div", {
            className: "flex items-center gap-2",
            children: [
              e.jsxs(_, {
                to: "/",
                className: "flex items-center gap-2 font-bold text-lg mr-6",
                children: [
                  e.jsx(L, {
                    className: "w-5 h-5 text-primary"
                  }),
                  e.jsx("span", {
                    children: "SillyTavern Lite"
                  })
                ]
              }),
              e.jsxs("nav", {
                className: "flex items-center gap-1",
                children: [
                  e.jsxs(_, {
                    to: "/plaza/characters",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(X, {
                        className: "w-4 h-4"
                      }),
                      "\u5E7F\u573A"
                    ]
                  }),
                  e.jsxs(_, {
                    to: "/create",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(Y, {
                        className: "w-4 h-4"
                      }),
                      "\u5DE5\u574A"
                    ]
                  }),
                  e.jsxs(_, {
                    to: "/session",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(fe, {
                        className: "w-4 h-4"
                      }),
                      "\u4F1A\u8BDD"
                    ]
                  })
                ]
              })
            ]
          })
        }),
        e.jsx("main", {
          className: "grow overflow-auto flex flex-col",
          children: e.jsx(A, {})
        })
      ]
    });
  }
  const ws = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Cs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function $s() {
    const n = N();
    return j.useEffect(() => {
      const r = setTimeout(() => {
        n({
          to: "/plaza/characters"
        });
      }, 3e3);
      return () => clearTimeout(r);
    }, [
      n
    ]), e.jsxs("div", {
      className: "flex flex-col items-center justify-center h-full bg-background space-y-6",
      children: [
        e.jsxs("div", {
          className: "relative",
          children: [
            e.jsx("div", {
              className: "absolute -inset-1 rounded-full bg-primary/20 blur-xl animate-pulse"
            }),
            e.jsx(L, {
              className: "w-20 h-20 text-primary relative"
            })
          ]
        }),
        e.jsxs("div", {
          className: "text-center space-y-2",
          children: [
            e.jsx("h1", {
              className: "text-4xl font-bold tracking-tight",
              children: "SillyTavern Lite"
            }),
            e.jsx("p", {
              className: "text-muted-foreground",
              children: "\u6B22\u8FCE\u56DE\u6765\uFF0C\u521B\u4F5C\u8005"
            })
          ]
        }),
        e.jsx("div", {
          className: "flex items-center gap-2 text-sm text-muted-foreground animate-bounce",
          children: e.jsx("span", {
            children: "\u5373\u5C06\u8FDB\u5165\u5E7F\u573A..."
          })
        })
      ]
    });
  }
  const Ss = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: $s
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Is() {
    const n = N(), { sessionId: r } = ue({
      strict: false
    }), { data: l = [] } = y((c) => c.from({
      s: E
    })), { data: t = [] } = y((c) => c.from({
      c: $
    })), a = (c) => {
      n({
        to: "/session/$sessionId",
        params: {
          sessionId: c.id
        }
      });
    }, x = () => {
      n({
        to: "/plaza/characters"
      });
    }, p = async (c) => {
      try {
        await f.sessions.delete(c.id);
      } catch (o) {
        console.error("Failed to delete session:", o);
      }
    };
    return e.jsxs("div", {
      className: "flex h-full overflow-hidden",
      children: [
        e.jsx(be, {
          sessions: l,
          characters: t,
          activeSessionId: r,
          onSessionSelect: a,
          onNewSession: x,
          onSessionDelete: p
        }),
        e.jsx("div", {
          className: "grow overflow-hidden relative",
          children: e.jsx(A, {})
        })
      ]
    });
  }
  const Ps = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Is
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Os() {
    const r = xe().pathname.includes("challenges") ? "challenges" : "characters";
    return e.jsxs("div", {
      className: "flex flex-col h-full overflow-y-auto",
      children: [
        e.jsx("div", {
          className: "border-b px-6 py-2 bg-muted/20",
          children: e.jsx(G, {
            value: r,
            className: "w-fit",
            children: e.jsxs(H, {
              children: [
                e.jsx(_, {
                  to: "/plaza/characters",
                  children: e.jsx(w, {
                    value: "characters",
                    children: "\u89D2\u8272\u5361"
                  })
                }),
                e.jsx(_, {
                  to: "/plaza/challenges",
                  children: e.jsx(w, {
                    value: "challenges",
                    className: "cursor-pointer",
                    children: "\u6311\u6218\u5361"
                  })
                })
              ]
            })
          })
        }),
        e.jsx("div", {
          className: "p-6",
          children: e.jsx(A, {})
        })
      ]
    });
  }
  const ks = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Os
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ds() {
    return e.jsxs("div", {
      className: "p-6 max-w-4xl mx-auto space-y-8",
      children: [
        e.jsxs("div", {
          className: "space-y-2",
          children: [
            e.jsxs("h1", {
              className: "text-3xl font-bold flex items-center gap-2",
              children: [
                e.jsx(Y, {
                  className: "w-8 h-8 text-primary"
                }),
                "\u521B\u4F5C\u8005\u5DE5\u574A"
              ]
            }),
            e.jsx("p", {
              className: "text-muted-foreground",
              children: "\u5728\u8FD9\u91CC\u521B\u5EFA\u548C\u7BA1\u7406\u4F60\u7684\u89D2\u8272\u5361\u4E0E\u6311\u6218\u6311\u6218\u8BBE\u5B9A\u3002"
            })
          ]
        }),
        e.jsxs("div", {
          className: "grid grid-cols-1 md:grid-cols-2 gap-6",
          children: [
            e.jsx(_, {
              to: "/create/character",
              children: e.jsxs(O, {
                className: "hover:border-primary transition-colors cursor-pointer group h-full",
                children: [
                  e.jsxs(k, {
                    children: [
                      e.jsx(X, {
                        className: "w-10 h-10 mb-2 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(D, {
                        children: "\u65B0\u89D2\u8272\u5361"
                      }),
                      e.jsx(z, {
                        children: "\u5B9A\u4E49\u89D2\u8272\u7684\u4EBA\u683C\u3001\u80CC\u666F\u3001\u5F00\u573A\u767D\u548C\u5BF9\u8BDD\u98CE\u683C\u3002"
                      })
                    ]
                  }),
                  e.jsx(R, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-primary",
                      children: [
                        "\u7ACB\u5373\u5F00\u59CB ",
                        e.jsx(q, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            }),
            e.jsx(_, {
              to: "/create/challenge",
              children: e.jsxs(O, {
                className: "hover:border-primary transition-colors cursor-pointer group h-full",
                children: [
                  e.jsxs(k, {
                    children: [
                      e.jsx(Z, {
                        className: "w-10 h-10 mb-2 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(D, {
                        children: "\u65B0\u6311\u6218\u5361"
                      }),
                      e.jsx(z, {
                        children: "\u8BBE\u5B9A\u4E16\u754C\u53D8\u91CF\u3001\u6210\u5C31\u76EE\u6807\u548C DM \u7684\u5F15\u5BFC\u89C4\u5219\u3002"
                      })
                    ]
                  }),
                  e.jsx(R, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-primary",
                      children: [
                        "\u7ACB\u5373\u5F00\u59CB ",
                        e.jsx(q, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            })
          ]
        })
      ]
    });
  }
  const zs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ds
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Rs() {
    const [n, r] = j.useState(false), l = e.jsxs(e.Fragment, {
      children: [
        e.jsx("h2", {
          className: "text-lg font-semibold mb-4",
          children: "\u914D\u7F6E\u7BA1\u7406"
        }),
        e.jsxs("ul", {
          className: "space-y-2",
          children: [
            e.jsx("li", {
              children: e.jsx(_, {
                to: "/config/overview",
                className: "block p-2 rounded hover:bg-foreground/5 md:hover:bg-background",
                onClick: () => r(false),
                children: "\u6982\u89C8"
              })
            }),
            e.jsx("li", {
              children: e.jsx(_, {
                to: "/config/llm",
                className: "block p-2 rounded hover:bg-foreground/5 md:hover:bg-background",
                onClick: () => r(false),
                children: "LLM \u914D\u7F6E"
              })
            })
          ]
        })
      ]
    });
    return e.jsxs("div", {
      className: "flex h-full",
      children: [
        e.jsx("nav", {
          className: "hidden md:block w-64 p-4 bg-foreground/5 overflow-y-auto",
          children: l
        }),
        e.jsxs(Ae, {
          open: n,
          onOpenChange: r,
          children: [
            e.jsx(Le, {
              asChild: true,
              children: e.jsx(m, {
                variant: "outline",
                size: "icon",
                className: "md:hidden fixed bottom-8 left-8 rounded-full shadow-lg z-50",
                children: e.jsx(ve, {
                  className: "h-4 w-4"
                })
              })
            }),
            e.jsx(Ee, {
              side: "left",
              className: "w-64 p-4 overflow-y-auto",
              children: l
            })
          ]
        }),
        e.jsx("main", {
          className: "flex-1 p-4 lg:px-8 xl:px-12 overflow-auto",
          children: e.jsx(A, {})
        })
      ]
    });
  }
  const Ts = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Rs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function As() {
    return e.jsx(ge, {
      to: "/config/overview"
    });
  }
  const Ls = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: As
  }, Symbol.toStringTag, {
    value: "Module"
  })), Es = j.lazy(() => h(() => import("./app-libs-for-silly-tavern-BlnpFFoU.js").then((n) => n.q), __vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then((n) => ({
    default: n.SessionMainForChat
  }))), Ms = j.lazy(() => h(() => import("./app-libs-for-silly-tavern-BlnpFFoU.js").then((n) => n.r), __vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then((n) => ({
    default: n.SessionMainForChallenge
  })));
  function Fs() {
    var _a;
    const { sessionId: n } = K.useParams(), r = K.useSearch(), { data: l = [] } = y((x) => x.from({
      s: E
    }).where(({ s: p }) => je(p.id, n))), a = ((_a = l[0]) == null ? void 0 : _a.mode) || r.mode;
    return e.jsx(j.Suspense, {
      fallback: e.jsx("div", {
        className: "flex flex-col items-center justify-center h-full text-muted-foreground space-y-4",
        children: e.jsx("p", {
          children: "\u52A0\u8F7D\u4E2D..."
        })
      }),
      children: a === "challenge" ? e.jsx(Ms, {
        sessionId: n
      }) : e.jsx(Es, {
        sessionId: n
      })
    });
  }
  const Vs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Fs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Us() {
    const n = N(), [r, l] = j.useState(false), { data: t = [] } = y((s) => s.from({
      c: $
    })), a = (s) => {
      n({
        to: "/characters/$characterId",
        params: {
          characterId: s.id
        }
      });
    }, x = (s) => {
      n({
        to: "/characters/$characterId",
        params: {
          characterId: s.id
        }
      });
    }, p = async (s) => {
      try {
        await f.characters.add(s), i.success(`\u6210\u529F\u5BFC\u5165\u89D2\u8272: ${s.name}`);
      } catch (d) {
        i.error("\u5BFC\u5165\u5931\u8D25"), console.error(d);
      }
    }, c = async () => {
      try {
        let s = 0;
        for (const d of $e) try {
          await f.characters.add(d), s++;
        } catch (v) {
          console.error(`Failed to import preset ${d.name}:`, v);
        }
        s > 0 ? i.success(`\u6210\u529F\u5BFC\u5165 ${s} \u4E2A\u89D2\u8272\u9884\u8BBE`) : i.error("\u6CA1\u6709\u627E\u5230\u53EF\u5BFC\u5165\u7684\u89D2\u8272\u9884\u8BBE");
      } catch (s) {
        i.error("\u5BFC\u5165\u9884\u8BBE\u5931\u8D25"), console.error(s);
      }
    }, o = e.jsxs("div", {
      className: "flex items-center gap-2",
      children: [
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: () => l(true),
          children: [
            e.jsx(ee, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u89D2\u8272"
          ]
        }),
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: c,
          children: [
            e.jsx(L, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u9884\u8BBE"
          ]
        }),
        e.jsx(we, {
          characters: t
        }),
        e.jsxs(m, {
          variant: "default",
          size: "sm",
          className: "flex items-center gap-2",
          onClick: () => n({
            to: "/create/character"
          }),
          type: "button",
          children: [
            e.jsx(se, {
              className: "w-4 h-4"
            }),
            "\u65B0\u5EFA\u89D2\u8272"
          ]
        }),
        e.jsx(re, {
          open: r,
          onOpenChange: l,
          onImport: p
        })
      ]
    });
    return e.jsx(oe, {
      items: t,
      title: "\u89D2\u8272\u5217\u8868",
      placeholder: "\u641C\u7D22\u540D\u79F0\u3001\u63CF\u8FF0\u6216\u6807\u7B7E...",
      actions: o,
      getSearchableContent: (s) => `${s.name} ${s.description} ${s.tags.join(" ")}`,
      getTags: (s) => s.tags,
      getId: (s) => s.id,
      renderCard: (s) => e.jsx(Ce, {
        character: s,
        onClick: x,
        onStartSession: a
      })
    });
  }
  const Bs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Us
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Gs() {
    const n = N(), [r, l] = j.useState(false), { data: t = [] } = y((o) => o.from({
      c: ce
    })), a = (o) => {
      n({
        to: "/challenges/$challengeId",
        params: {
          challengeId: o.id
        }
      });
    }, x = (o) => {
      n({
        to: "/challenges/$challengeId",
        params: {
          challengeId: o.id
        }
      });
    }, p = async () => {
      try {
        let o = 0;
        for (const s of Ie) try {
          await f.challenges.add(s), o++;
        } catch (d) {
          console.error(`Failed to import preset ${s.name}:`, d);
        }
        o > 0 ? i.success(`\u6210\u529F\u5BFC\u5165 ${o} \u4E2A\u6311\u6218\u9884\u8BBE`) : i.error("\u6CA1\u6709\u627E\u5230\u53EF\u5BFC\u5165\u7684\u6311\u6218\u9884\u8BBE");
      } catch (o) {
        i.error("\u5BFC\u5165\u9884\u8BBE\u5931\u8D25"), console.error(o);
      }
    }, c = e.jsxs("div", {
      className: "flex items-center gap-2",
      children: [
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: () => l(true),
          children: [
            e.jsx(ee, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u6311\u6218"
          ]
        }),
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: p,
          children: [
            e.jsx(L, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u9884\u8BBE"
          ]
        }),
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          children: [
            e.jsx(P, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u51FA\u6240\u6709"
          ]
        }),
        e.jsxs(m, {
          variant: "default",
          size: "sm",
          className: "flex items-center gap-2",
          onClick: () => n({
            to: "/create/challenge"
          }),
          type: "button",
          children: [
            e.jsx(se, {
              className: "w-4 h-4"
            }),
            "\u65B0\u5EFA\u6311\u6218"
          ]
        }),
        e.jsx(re, {
          open: r,
          onOpenChange: l,
          onImport: (o) => {
            i.success(`\u6210\u529F\u5BFC\u5165\u6311\u6218: ${o.name}`);
          }
        })
      ]
    });
    return e.jsx("div", {
      className: "relative",
      children: e.jsx(oe, {
        items: t,
        title: "\u6311\u6218\u5217\u8868",
        placeholder: "\u641C\u7D22\u540D\u79F0\u3001\u63CF\u8FF0\u6216\u6807\u7B7E...",
        actions: c,
        getSearchableContent: (o) => {
          var _a;
          return `${o.name} ${o.description} ${((_a = o.tags) == null ? void 0 : _a.join(" ")) || ""}`;
        },
        getTags: (o) => o.tags || [],
        getId: (o) => o.id,
        renderCard: (o) => e.jsx(Se, {
          challenge: o,
          onClick: x,
          onStartSession: a
        })
      })
    });
  }
  const Hs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Gs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function qs() {
    const n = N(), r = async (t) => {
      if (!t.name) {
        i.error("\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A");
        return;
      }
      try {
        const a = Date.now(), p = {
          id: crypto.randomUUID(),
          name: t.name,
          description: t.description || "",
          personality: t.personality || "",
          scenario: t.scenario || "",
          first_mes: t.first_mes || "",
          mes_example: t.mes_example || "",
          creator_notes: t.creator_notes || "",
          system_prompt: t.system_prompt || "",
          post_history_instructions: t.post_history_instructions || "",
          alternate_greetings: t.alternate_greetings || [],
          tags: t.tags || [],
          extensions: t.extensions || {},
          assets: t.assets,
          avatar: t.avatar,
          imageBase64: t.imageBase64,
          character_book: t.character_book,
          nickname: t.nickname,
          source: t.source,
          creation_date: t.creation_date || a,
          modification_date: t.modification_date || a,
          creator: "User",
          character_version: "1.0",
          group_only_greetings: [],
          createdAt: a,
          updatedAt: a
        };
        await f.characters.add(p);
        const c = p;
        i.success(`\u89D2\u8272 ${c.name} \u5DF2\u521B\u5EFA`), n({
          to: "/plaza/characters"
        });
      } catch (a) {
        i.error("\u521B\u5EFA\u5931\u8D25"), console.error(a);
      }
    }, l = () => {
      n({
        to: "/create"
      });
    };
    return e.jsx("div", {
      className: "p-6 w-full max-w-5xl mx-auto",
      children: e.jsx(le, {
        className: "w-full",
        onSave: r,
        onCancel: l,
        mode: "create"
      })
    });
  }
  const Js = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: qs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ws() {
    const n = N(), r = async (t) => {
      try {
        const a = {
          ...t,
          id: ie(),
          createdAt: Date.now(),
          updatedAt: Date.now()
        };
        await f.challenges.add(a), i.success("\u6311\u6218\u5361\u521B\u5EFA\u6210\u529F"), n({
          to: "/plaza/challenges"
        });
      } catch (a) {
        console.error(a), i.error("\u4FDD\u5B58\u5931\u8D25");
      }
    }, l = () => {
      n({
        to: "/plaza/challenges"
      });
    };
    return e.jsx("div", {
      className: "p-6 relative",
      children: e.jsx(Pe, {
        onSave: r,
        onCancel: l
      })
    });
  }
  const Qs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ws
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ks() {
    const n = j.useId(), r = j.useId(), l = j.useId(), t = j.useId(), [a, x] = j.useState({
      appName: "My App",
      enableNotifications: true,
      theme: "auto",
      description: ""
    }), p = () => {
      i.success("\u8BBE\u7F6E\u5DF2\u4FDD\u5B58");
    }, c = (o, s) => {
      x((d) => ({
        ...d,
        [o]: s
      }));
    };
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsx("h1", {
          className: "text-2xl font-bold",
          children: "\u5E94\u7528\u8BBE\u7F6E"
        }),
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u7BA1\u7406\u5E94\u7528\u7684\u57FA\u672C\u914D\u7F6E\u548C\u504F\u597D\u8BBE\u7F6E\u3002"
        }),
        e.jsxs(O, {
          children: [
            e.jsxs(k, {
              children: [
                e.jsx(D, {
                  children: "\u57FA\u672C\u8BBE\u7F6E"
                }),
                e.jsx(z, {
                  children: "\u914D\u7F6E\u5E94\u7528\u7684\u57FA\u672C\u4FE1\u606F\u548C\u884C\u4E3A\u3002"
                })
              ]
            }),
            e.jsxs(R, {
              className: "space-y-4",
              children: [
                e.jsxs("div", {
                  className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                  children: [
                    e.jsxs("div", {
                      className: "space-y-2",
                      children: [
                        e.jsx(I, {
                          htmlFor: n,
                          children: "\u5E94\u7528\u540D\u79F0"
                        }),
                        e.jsx(W, {
                          id: n,
                          value: a.appName,
                          onChange: (o) => c("appName", o.target.value)
                        })
                      ]
                    }),
                    e.jsxs("div", {
                      className: "space-y-2",
                      children: [
                        e.jsx(I, {
                          htmlFor: r,
                          children: "\u4E3B\u9898"
                        }),
                        e.jsx(W, {
                          id: r,
                          value: a.theme,
                          onChange: (o) => c("theme", o.target.value)
                        })
                      ]
                    })
                  ]
                }),
                e.jsxs("div", {
                  className: "space-y-2",
                  children: [
                    e.jsx(I, {
                      htmlFor: l,
                      children: "\u63CF\u8FF0"
                    }),
                    e.jsx(Me, {
                      id: l,
                      value: a.description,
                      onChange: (o) => c("description", o.target.value),
                      placeholder: "\u8F93\u5165\u5E94\u7528\u63CF\u8FF0..."
                    })
                  ]
                }),
                e.jsxs("div", {
                  className: "flex items-center space-x-2",
                  children: [
                    e.jsx(Fe, {
                      id: t,
                      checked: a.enableNotifications,
                      onCheckedChange: (o) => c("enableNotifications", o)
                    }),
                    e.jsx(I, {
                      htmlFor: t,
                      children: "\u542F\u7528\u901A\u77E5"
                    })
                  ]
                }),
                e.jsx(m, {
                  onClick: p,
                  children: "\u4FDD\u5B58\u8BBE\u7F6E"
                })
              ]
            })
          ]
        })
      ]
    });
  }
  const Xs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ks
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ys() {
    const n = [
      {
        name: "LLM \u914D\u7F6E",
        path: "/config/llm",
        description: "\u7BA1\u7406 LLM \u6A21\u578B\u914D\u7F6E\u3001API \u5BC6\u94A5\u548C\u8C03\u7528\u53C2\u6570\u3002"
      }
    ];
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsx("h1", {
          className: "text-2xl font-bold",
          children: "\u914D\u7F6E\u7BA1\u7406\u6982\u89C8"
        }),
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u8FD9\u91CC\u60A8\u53EF\u4EE5\u7BA1\u7406\u672C\u5E94\u7528\u4E2D\u7684\u5404\u79CD\u914D\u7F6E\uFF0C\u5305\u62EC\u5E94\u7528\u8BBE\u7F6E\u3001\u7528\u6237\u504F\u597D\u548C\u7CFB\u7EDF\u53C2\u6570\u3002"
        }),
        e.jsx("div", {
          className: "grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",
          children: n.map((r) => e.jsxs(O, {
            className: "hover:shadow-md transition-shadow",
            children: [
              e.jsx(k, {
                children: e.jsx(D, {
                  className: "text-lg",
                  children: r.name
                })
              }),
              e.jsxs(R, {
                children: [
                  e.jsx(z, {
                    className: "mb-4",
                    children: r.description
                  }),
                  e.jsx(m, {
                    asChild: true,
                    children: e.jsx(_, {
                      to: r.path,
                      children: "\u67E5\u770B\u8BE6\u60C5"
                    })
                  })
                ]
              })
            ]
          }, r.path))
        })
      ]
    });
  }
  const Zs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ys
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function et() {
    const n = xs.useNavigate(), { config: r, setConfig: l, models: t, isFetchingModels: a, fetchModels: x, customParamList: p, addCustomParam: c, updateCustomParam: o, removeCustomParam: s } = Ye();
    return e.jsxs("div", {
      className: "container max-w-4xl mx-auto p-4 space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsx("h1", {
              className: "text-3xl font-bold",
              children: "\u5168\u5C40 LLM \u914D\u7F6E"
            }),
            e.jsx(m, {
              onClick: () => n({
                to: ".."
              }),
              children: "\u8FD4\u56DE"
            })
          ]
        }),
        e.jsx(Xe, {
          config: r,
          setConfig: l,
          models: t,
          isFetchingModels: a,
          fetchModels: x,
          customParamList: p,
          addCustomParam: c,
          updateCustomParam: o,
          removeCustomParam: s
        })
      ]
    });
  }
  const st = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: et
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function tt() {
    const { characterId: n } = js.useParams(), r = N(), { data: l = [] } = y((s) => s.from({
      c: $
    })), { data: t = [] } = y((s) => s.from({
      s: E
    })), a = l.find((s) => s.id === n), x = t.filter((s) => s.characterId === n);
    if (!a) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u89D2\u8272\u4E0D\u5B58\u5728"
        }),
        e.jsx(m, {
          onClick: () => r({
            to: "/plaza/characters"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const p = async (s) => {
      if (s === "challenge") {
        i.info("\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u6311\u6218\u5267\u672C\u4EE5\u5F00\u59CB\u6311\u6218\u6A21\u5F0F"), r({
          to: "/plaza/challenges"
        });
        return;
      }
      try {
        const d = crypto.randomUUID(), v = Date.now(), S = {
          id: d,
          title: s === "chat" ? `\u4E0E ${a.name} \u7684\u804A\u5929` : `\u6311\u6218: ${a.name}`,
          contextId: null,
          mode: s,
          modeConfig: {},
          modeState: {},
          characterId: a.id,
          challengeId: void 0,
          createdAt: v,
          updatedAt: v,
          isActive: true
        };
        await f.sessions.add(S), r({
          to: "/session/$sessionId",
          params: {
            sessionId: d
          },
          search: {
            mode: s
          }
        });
      } catch (d) {
        console.error("Failed to create session:", d), i.error("\u521B\u5EFA\u4F1A\u8BDD\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, c = () => {
      try {
        if (!a.imageBase64) {
          i.error("\u8BE5\u89D2\u8272\u6CA1\u6709\u5934\u50CF\u56FE\u7247\uFF0C\u65E0\u6CD5\u5BFC\u51FA\u4E3A PNG \u89D2\u8272\u5361");
          return;
        }
        const s = ze(a), d = URL.createObjectURL(s), v = document.createElement("a");
        v.href = d, v.download = `${a.name}.png`, v.click(), URL.revokeObjectURL(d), i.success(`\u89D2\u8272 ${a.name} \u5DF2\u5BFC\u51FA\u4E3A PNG \u89D2\u8272\u5361`);
      } catch (s) {
        console.error(s), i.error("\u5BFC\u51FA PNG \u89D2\u8272\u5361\u5931\u8D25");
      }
    }, o = async () => {
      try {
        const s = t.filter((d) => d.characterId === n);
        for (const d of s) await f.sessions.delete(d.id);
        await f.characters.delete(n), i.success("\u89D2\u8272\u5DF2\u5220\u9664"), r({
          to: "/plaza/characters"
        });
      } catch (s) {
        console.error("Failed to delete character:", s), i.error("\u5220\u9664\u89D2\u8272\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    };
    return e.jsxs("div", {
      className: "w-full max-w-5xl mx-auto p-4 md:p-8 space-y-8 animate-in fade-in duration-500",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs(m, {
              variant: "ghost",
              size: "sm",
              className: "mb-2 -ml-2 text-muted-foreground hover:bg-transparent",
              onClick: () => r({
                to: "/plaza/characters"
              }),
              type: "button",
              children: [
                e.jsx(B, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u8FD4\u56DE\u89D2\u8272\u5E7F\u573A"
              ]
            }),
            e.jsxs("div", {
              className: "flex items-center gap-2",
              children: [
                e.jsxs(M, {
                  children: [
                    e.jsx(F, {
                      asChild: true,
                      children: e.jsxs(m, {
                        variant: "outline",
                        size: "sm",
                        className: "flex gap-2 h-8 rounded-lg",
                        type: "button",
                        children: [
                          e.jsx(P, {
                            className: "w-4 h-4"
                          }),
                          "\u5BFC\u51FA"
                        ]
                      })
                    }),
                    e.jsxs(V, {
                      align: "end",
                      className: "w-56",
                      children: [
                        e.jsx(Ve, {
                          children: "\u9009\u62E9\u5BFC\u51FA\u683C\u5F0F"
                        }),
                        e.jsx(Q, {}),
                        e.jsxs(b, {
                          onClick: c,
                          children: [
                            e.jsx(_e, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5BFC\u51FA PNG \u89D2\u8272\u5361 (\u63A8\u8350)"
                          ]
                        }),
                        e.jsx(Oe, {
                          character: a,
                          trigger: e.jsxs(b, {
                            onSelect: (s) => s.preventDefault(),
                            children: [
                              e.jsx(ye, {
                                className: "mr-2 h-4 w-4"
                              }),
                              " \u5BFC\u51FA JSON \u539F\u59CB\u6570\u636E"
                            ]
                          })
                        })
                      ]
                    })
                  ]
                }),
                e.jsxs(M, {
                  children: [
                    e.jsx(F, {
                      asChild: true,
                      children: e.jsx(m, {
                        variant: "ghost",
                        size: "icon",
                        className: "h-8 w-8 rounded-full",
                        type: "button",
                        children: e.jsx(te, {
                          className: "w-4 h-4"
                        })
                      })
                    }),
                    e.jsxs(V, {
                      align: "end",
                      className: "w-48",
                      children: [
                        e.jsxs(b, {
                          onClick: () => r({
                            to: "/characters/$characterId/edit",
                            params: {
                              characterId: a.id
                            }
                          }),
                          children: [
                            e.jsx(J, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u7F16\u8F91\u89D2\u8272"
                          ]
                        }),
                        e.jsxs(b, {
                          children: [
                            e.jsx(ae, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5206\u4EAB\u89D2\u8272"
                          ]
                        }),
                        e.jsx(Q, {}),
                        e.jsxs(Ue, {
                          children: [
                            e.jsx(Be, {
                              asChild: true,
                              children: e.jsxs(b, {
                                onSelect: (s) => s.preventDefault(),
                                className: "text-destructive focus:bg-destructive/10 focus:text-destructive",
                                children: [
                                  e.jsx(ne, {
                                    className: "mr-2 h-4 w-4"
                                  }),
                                  " \u5220\u9664\u89D2\u8272"
                                ]
                              })
                            }),
                            e.jsxs(Ge, {
                              children: [
                                e.jsxs(He, {
                                  children: [
                                    e.jsx(qe, {
                                      children: "\u786E\u8BA4\u5220\u9664\u89D2\u8272"
                                    }),
                                    e.jsxs(Je, {
                                      children: [
                                        '\u786E\u5B9A\u8981\u5220\u9664\u89D2\u8272 "',
                                        a.name,
                                        '" \u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\uFF0C\u4E14\u4F1A\u6E05\u9664\u6240\u6709\u5173\u8054\u7684\u4F1A\u8BDD\u8BB0\u5F55\u3002'
                                      ]
                                    })
                                  ]
                                }),
                                e.jsxs(We, {
                                  children: [
                                    e.jsx(Qe, {
                                      children: "\u53D6\u6D88"
                                    }),
                                    e.jsx(Ke, {
                                      onClick: o,
                                      className: "bg-destructive hover:bg-destructive/90",
                                      children: "\u786E\u8BA4\u5220\u9664"
                                    })
                                  ]
                                })
                              ]
                            })
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs("div", {
          className: "flex flex-col md:flex-row gap-8 items-start pb-8 border-b",
          children: [
            e.jsx("div", {
              className: "w-40 h-40 rounded-3xl bg-muted flex items-center justify-center shrink-0 border-4 border-background shadow-xl overflow-hidden",
              children: a.imageBase64 || a.avatar ? e.jsx("img", {
                src: a.imageBase64 || a.avatar,
                alt: a.name,
                className: "w-full h-full object-cover"
              }) : e.jsx(Ne, {
                className: "w-20 h-20 text-muted-foreground/30"
              })
            }),
            e.jsxs("div", {
              className: "space-y-5 grow",
              children: [
                e.jsxs("div", {
                  className: "space-y-1",
                  children: [
                    e.jsxs("div", {
                      className: "flex items-center gap-3",
                      children: [
                        e.jsx("h1", {
                          className: "text-4xl font-extrabold tracking-tight",
                          children: a.name
                        }),
                        e.jsxs(m, {
                          variant: "outline",
                          size: "sm",
                          onClick: () => r({
                            to: "/characters/$characterId/edit",
                            params: {
                              characterId: a.id
                            }
                          }),
                          className: "flex items-center gap-2",
                          type: "button",
                          children: [
                            e.jsx(J, {
                              className: "w-4 h-4"
                            }),
                            "\u7F16\u8F91"
                          ]
                        })
                      ]
                    }),
                    e.jsx("p", {
                      className: "text-xl text-muted-foreground font-medium",
                      children: a.nickname || a.name
                    })
                  ]
                }),
                e.jsx("div", {
                  className: "flex flex-wrap gap-2",
                  children: a.tags.map((s) => e.jsx(U, {
                    variant: "secondary",
                    className: "px-3 py-1 font-medium",
                    children: s
                  }, s))
                }),
                e.jsxs("p", {
                  className: "text-base leading-relaxed text-muted-foreground/90 max-w-2xl",
                  children: [
                    a.description.slice(0, 200),
                    a.description.length > 200 ? "..." : ""
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs(G, {
          defaultValue: "sessions",
          className: "w-full",
          children: [
            e.jsxs(H, {
              className: "w-full justify-start h-12 bg-muted/50 p-1 mb-6",
              children: [
                e.jsx(w, {
                  value: "sessions",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u4F1A\u8BDD & \u8BB0\u5F55"
                }),
                e.jsx(w, {
                  value: "details",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u6863\u6848\u8BE6\u60C5"
                })
              ]
            }),
            e.jsx(T, {
              value: "sessions",
              className: "mt-0",
              children: e.jsx("div", {
                className: "grid grid-cols-1 md:grid-cols-1 gap-8",
                children: e.jsx(ke, {
                  characterId: a.id,
                  sessions: x,
                  onStartNew: p
                })
              })
            }),
            e.jsx(T, {
              value: "details",
              className: "mt-0",
              children: e.jsx(De, {
                character: a
              })
            })
          ]
        })
      ]
    });
  }
  const at = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: tt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function nt() {
    var _a;
    const { challengeId: n } = vs.useParams(), r = N(), { data: l = [] } = y((s) => s.from({
      c: ce
    })), t = l.find((s) => s.id === n), { data: a = [] } = y((s) => s.from({
      s: E
    })), { data: x = [] } = y((s) => s.from({
      char: $
    })), p = a.filter((s) => s.challengeId === n);
    if (!t) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u6311\u6218\u4E0D\u5B58\u5728"
        }),
        e.jsx(m, {
          onClick: () => r({
            to: "/plaza/challenges"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const c = async (s) => {
      try {
        const d = ie(), v = Date.now(), S = {};
        for (const [C, me] of Object.entries(t.variables)) S[C] = {
          key: C,
          value: me.initial
        };
        const de = {
          id: d,
          title: `${t.name}`,
          contextId: null,
          mode: "challenge",
          modeConfig: {
            characterId: s,
            roleTaskPrompt: t.roleTaskPrompt,
            userGuidance: t.userGuidance,
            variables: t.variables,
            goals: t.goals,
            failureChecks: t.failureChecks
          },
          modeState: {
            currentPhase: "dm_intro",
            currentUIState: "idle",
            variableStates: S,
            goalStates: t.goals.map((C) => ({
              key: C.key,
              checkCount: 0,
              isMet: false
            })),
            failureStates: t.failureChecks.map((C) => ({
              key: C.key,
              checkCount: 0,
              isMet: false
            }))
          },
          characterId: s,
          challengeId: t.id,
          createdAt: v,
          updatedAt: v,
          isActive: true
        };
        await f.sessions.add(de), r({
          to: "/session/$sessionId",
          params: {
            sessionId: d
          },
          search: {
            mode: "challenge"
          }
        });
      } catch (d) {
        console.error("Failed to create challenge session:", d), i.error("\u521B\u5EFA\u4F1A\u8BDD\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, o = () => {
      i.success(`\u6B63\u5728\u5BFC\u51FA\u6311\u6218 ${t.name}...`);
    };
    return e.jsxs("div", {
      className: "max-w-5xl mx-auto p-4 md:p-8 space-y-8 animate-in fade-in slide-in-from-bottom-2 duration-500 relative",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs(m, {
              variant: "ghost",
              size: "sm",
              className: "mb-2 -ml-2 text-muted-foreground hover:bg-transparent",
              onClick: () => r({
                to: "/plaza/challenges"
              }),
              type: "button",
              children: [
                e.jsx(B, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u8FD4\u56DE\u6311\u6218\u5E7F\u573A"
              ]
            }),
            e.jsxs("div", {
              className: "flex items-center gap-2",
              children: [
                e.jsxs(m, {
                  variant: "outline",
                  size: "sm",
                  className: "hidden sm:flex gap-2 h-8 rounded-lg",
                  onClick: o,
                  type: "button",
                  children: [
                    e.jsx(P, {
                      className: "w-4 h-4"
                    }),
                    "\u5BFC\u51FA\u6311\u6218"
                  ]
                }),
                e.jsxs(M, {
                  children: [
                    e.jsx(F, {
                      asChild: true,
                      children: e.jsx(m, {
                        variant: "ghost",
                        size: "icon",
                        className: "h-8 w-8 rounded-full",
                        type: "button",
                        children: e.jsx(te, {
                          className: "w-4 h-4"
                        })
                      })
                    }),
                    e.jsxs(V, {
                      align: "end",
                      className: "w-48",
                      children: [
                        e.jsxs(b, {
                          onClick: o,
                          className: "sm:hidden",
                          children: [
                            e.jsx(P, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5BFC\u51FA JSON"
                          ]
                        }),
                        e.jsxs(b, {
                          children: [
                            e.jsx(ae, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5206\u4EAB\u6311\u6218"
                          ]
                        }),
                        e.jsxs(b, {
                          className: "text-destructive focus:bg-destructive/10 focus:text-destructive",
                          onClick: async () => {
                            confirm("\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u6311\u6218\u5417\uFF1F") && (await f.challenges.delete(t.id), i.success("\u6311\u6218\u5DF2\u5220\u9664"), r({
                              to: "/plaza/challenges"
                            }));
                          },
                          children: [
                            e.jsx(ne, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5220\u9664\u6311\u6218"
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs("div", {
          className: "flex flex-col md:flex-row gap-8 items-start pb-8 border-b",
          children: [
            e.jsx("div", {
              className: "w-40 h-40 rounded-3xl bg-primary/10 flex items-center justify-center shrink-0 border-4 border-background shadow-xl overflow-hidden",
              children: e.jsx(Z, {
                className: "w-20 h-20 text-primary"
              })
            }),
            e.jsxs("div", {
              className: "space-y-4 grow",
              children: [
                e.jsxs("div", {
                  className: "space-y-2",
                  children: [
                    e.jsx(U, {
                      variant: "outline",
                      className: "text-primary bg-primary/5 border-primary/20 uppercase tracking-widest text-[10px] px-2",
                      children: "Challenge Scenario"
                    }),
                    e.jsx("h1", {
                      className: "text-4xl font-extrabold tracking-tight",
                      children: t.name
                    })
                  ]
                }),
                e.jsx("div", {
                  className: "flex flex-wrap gap-2",
                  children: (_a = t.tags) == null ? void 0 : _a.map((s) => e.jsx(U, {
                    variant: "secondary",
                    className: "px-3 py-1 font-medium",
                    children: s
                  }, s))
                }),
                e.jsxs("p", {
                  className: "text-lg leading-relaxed text-muted-foreground italic font-serif",
                  children: [
                    '" ',
                    t.description.slice(0, 150),
                    '... "'
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs(G, {
          defaultValue: "details",
          className: "w-full",
          children: [
            e.jsxs(H, {
              className: "w-full justify-start h-12 bg-muted/50 p-1 mb-6",
              children: [
                e.jsx(w, {
                  value: "details",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u6311\u6218\u8BE6\u60C5"
                }),
                e.jsx(w, {
                  value: "sessions",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u5173\u8054\u4F1A\u8BDD"
                })
              ]
            }),
            e.jsx(T, {
              value: "details",
              className: "mt-0",
              children: e.jsx(Re, {
                challenge: t
              })
            }),
            e.jsx(T, {
              value: "sessions",
              className: "mt-0",
              children: e.jsx(Te, {
                challengeId: t.id,
                sessions: p,
                characters: x,
                onStartNew: c
              })
            })
          ]
        })
      ]
    });
  }
  const ot = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: nt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function rt() {
    const { characterId: n } = ys.useParams(), r = N(), { data: l = [] } = y((c) => c.from({
      c: $
    })), t = l.find((c) => c.id === n);
    if (!t) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u89D2\u8272\u4E0D\u5B58\u5728"
        }),
        e.jsx(m, {
          onClick: () => r({
            to: "/plaza/characters"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const a = async (c) => {
      try {
        const o = Date.now(), s = {
          ...t,
          ...c,
          updatedAt: o,
          modification_date: o
        };
        await f.characters.put(s), i.success(`\u89D2\u8272 ${t.name} \u5DF2\u66F4\u65B0`), r({
          to: "/characters/$characterId",
          params: {
            characterId: t.id
          }
        });
      } catch (o) {
        console.error("Failed to update character:", o), i.error("\u66F4\u65B0\u89D2\u8272\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, x = () => {
      r({
        to: "/characters/$characterId",
        params: {
          characterId: t.id
        }
      });
    }, p = t;
    return e.jsxs("div", {
      className: "w-full max-w-5xl mx-auto p-4 md:p-8 space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center gap-2",
          children: [
            e.jsxs(m, {
              variant: "ghost",
              size: "sm",
              className: "text-muted-foreground hover:bg-transparent",
              onClick: x,
              type: "button",
              children: [
                e.jsx(B, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u53D6\u6D88\u7F16\u8F91"
              ]
            }),
            e.jsxs("h1", {
              className: "text-xl font-bold",
              children: [
                "\u7F16\u8F91\u89D2\u8272: ",
                t.name
              ]
            })
          ]
        }),
        e.jsx(le, {
          onSave: a,
          onCancel: x,
          initialData: p,
          mode: "edit"
        })
      ]
    });
  }
  const ct = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: rt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
})();
export {
  jt as R,
  __tla,
  ft as a,
  vt as b,
  _t as c,
  yt as d,
  Nt as e,
  bt as f,
  Ct as g,
  wt as h,
  K as i,
  $t as j,
  St as k,
  It as l,
  Pt as m,
  Ot as n,
  kt as o,
  xs as p,
  js as q,
  vs as r,
  ys as s
};

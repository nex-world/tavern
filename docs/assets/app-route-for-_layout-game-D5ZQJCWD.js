const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-libs-for-silly-tavern-B25rjgZe.js","assets/react-C1-gKlL3.js","assets/index-Dpc698w9.js","assets/@tanstack-D0F3M8cX.js","assets/vendor-DiUPmCJW.js","assets/dexie-CYn1VVOQ.js","assets/app-components-Cazi3mLF.js","assets/icons-D0dskdnL.js","assets/app-hooks-DuiTjjKo.js","assets/id-OxPLOBIU.js","assets/future-lib-llm-ui-react-Dc-qGejy.js","assets/es-toolkit-CstbrnlE.js","assets/app-lib-Lqu2MNa0.js","assets/components-and-styling-lnR2ABT4.js","assets/@tailwind-COJ8Fh6m.js","assets/zod-grrOrvCS.js","assets/app-libs-for-custom-theme-x6QHZUKD.js","assets/gsap-DDlvirwQ.js","assets/app-components-DvwNuPEv.css","assets/@radix-ui-BQCqNqg0.js","assets/immer-BCQU3qJI.js","assets/app-styles-DkvAwDr2.css"])))=>i.map(i=>d[i]);
import { _ as p, D as Oe } from "./index-Dpc698w9.js";
import { g, l as j, r as ze, L as v, O as W, e as C, h as Re, i as y, f as ke, N as Te, j as Ae } from "./@tanstack-D0F3M8cX.js";
import { j as e, r as f, t as m } from "./react-C1-gKlL3.js";
import { f as q, U as H, H as je, g as Ee, a as M, h as fe, i as V, M as G, j as Le, P as T, k as J, l as ve, m as _e, D as U, n as le, o as Me, F as Fe, E as Ne, p as pe, q as ye, r as Ve } from "./icons-D0dskdnL.js";
import { S as Ge, a as A, C as L, m as N, b as be, c as Ue, E as Be, I as Ce, d as We, e as we, f as qe, g as He, G as Je, D as Qe, h as Se, i as Ke, j as Xe, k as Ye, l as Ze, n as $e, o as es, p as ss, q as ts } from "./app-libs-for-silly-tavern-B25rjgZe.js";
import { y as ie, z as de, A as P, C as w, E as D, F as O, G as z, H as S, S as as, J as ns, B as h, K as rs, L as Q, N as K, O as X, P as Y, Q as Z, R as ee, U as se, V as te, W as ae, d as R, X as F, f as xe, Y as os, Z as cs, _ as re, $ as oe, a0 as ce, a1 as ls, a2 as ue, a3 as I, a4 as B } from "./app-components-Cazi3mLF.js";
import { n as Ie } from "./id-OxPLOBIU.js";
import { C as is } from "./future-lib-llm-ui-react-Dc-qGejy.js";
import { a as ds } from "./app-lib-Lqu2MNa0.js";
let Ut, Bt, Wt, qt, Ht, Jt, Qt, Kt, Xt, ge, Yt, Zt, ea, sa, ta, aa, na, ra, oa, ca, Os, Rs, Ts, Es;
let __tla = (async () => {
  let ms, hs, ps, xs, us, gs, js, fs, vs, _s, Ns, ys, bs, Cs, ws, Ss, $s, Is, Ps, Ds, zs, ks, As, Ls, Ms;
  ms = () => p(() => Promise.resolve().then(() => Ms), void 0);
  Ut = g("/_layout-game")({
    component: j(ms, "component")
  });
  hs = () => p(() => Promise.resolve().then(() => Vs), void 0);
  Bt = g("/_layout-game/_silly-tavern")({
    head: () => ({
      meta: [
        {
          title: "SillyTavern Lite | AI \u89D2\u8272\u626E\u6F14\u5E73\u53F0"
        },
        {
          name: "description",
          content: "\u8F7B\u91CF\u7EA7 AI \u89D2\u8272\u626E\u6F14\u5E73\u53F0\uFF0C\u652F\u6301\u89D2\u8272\u5361\u521B\u5EFA\u3001\u6311\u6218\u8BBE\u5B9A\u548C\u5BF9\u8BDD\u4F1A\u8BDD\u7BA1\u7406"
        }
      ]
    }),
    component: j(hs, "component")
  });
  ps = () => p(() => Promise.resolve().then(() => Us), void 0);
  Wt = g("/_layout-game/_silly-tavern/")({
    head: () => ({
      meta: [
        {
          title: "\u6B22\u8FCE\u6765\u5230 SillyTavern Lite | Welcome to SillyTavern Lite"
        },
        {
          name: "description",
          content: "\u6B22\u8FCE\u4F7F\u7528 SillyTavern Lite\uFF0CAI \u89D2\u8272\u626E\u6F14\u521B\u4F5C\u5E73\u53F0"
        }
      ]
    }),
    component: j(ps, "component")
  });
  xs = () => p(() => Promise.resolve().then(() => Ws), void 0);
  qt = g("/_layout-game/_silly-tavern/session")({
    head: () => ({
      meta: [
        {
          title: "\u5BF9\u8BDD\u4F1A\u8BDD | Chat Sessions"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u4F60\u7684 AI \u89D2\u8272\u626E\u6F14\u5BF9\u8BDD\u4F1A\u8BDD\uFF0C\u67E5\u770B\u5386\u53F2\u8BB0\u5F55\u548C\u7EE7\u7EED\u5BF9\u8BDD"
        }
      ]
    }),
    component: j(xs, "component")
  });
  us = () => p(() => Promise.resolve().then(() => Hs), void 0);
  Ht = g("/_layout-game/_silly-tavern/plaza")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5E7F\u573A | Character Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u89D2\u8272\u5361\u4E0E\u6311\u6218\u5361\uFF0C\u5F00\u59CB\u4F60\u7684 AI \u89D2\u8272\u626E\u6F14\u5192\u9669"
        }
      ]
    }),
    component: j(us, "component")
  });
  gs = () => p(() => Promise.resolve().then(() => Qs), void 0);
  Jt = g("/_layout-game/_silly-tavern/create")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u4F5C\u8005\u5DE5\u574A | Creator Workshop"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u548C\u7BA1\u7406\u4F60\u7684\u89D2\u8272\u5361\u4E0E\u6311\u6218\u8BBE\u5B9A\uFF0C\u6253\u9020\u72EC\u7279\u7684 AI \u89D2\u8272\u626E\u6F14\u4F53\u9A8C"
        }
      ]
    }),
    component: j(gs, "component")
  });
  js = () => p(() => Promise.resolve().then(() => Xs), void 0);
  Qt = g("/_layout-game/_silly-tavern/config")({
    head: () => ({
      meta: [
        {
          title: "\u914D\u7F6E\u7BA1\u7406 | Configuration"
        },
        {
          name: "description",
          content: "\u5E94\u7528\u914D\u7F6E\u7BA1\u7406\u4E2D\u5FC3\uFF0C\u5305\u62EC LLM \u914D\u7F6E\u3001\u7CFB\u7EDF\u8BBE\u7F6E\u7B49"
        }
      ]
    }),
    component: j(js, "component")
  });
  Kt = g("/_layout-game/_silly-tavern/plaza/")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5E7F\u573A | Character Plaza"
        },
        {
          name: "description",
          content: "SillyTavern \u89D2\u8272\u5E7F\u573A\uFF0C\u6D4F\u89C8\u89D2\u8272\u5361\u548C\u6311\u6218\u5361"
        }
      ]
    }),
    beforeLoad: () => {
      throw ze({
        to: "/plaza/characters"
      });
    }
  });
  fs = () => p(() => Promise.resolve().then(() => Zs), void 0);
  Xt = g("/_layout-game/_silly-tavern/config/")({
    component: j(fs, "component")
  });
  vs = () => p(() => Promise.resolve().then(() => rt), void 0);
  ge = g("/_layout-game/_silly-tavern/session/$sessionId")({
    head: () => ({
      meta: [
        {
          title: "\u5BF9\u8BDD\u4F1A\u8BDD | Chat Session"
        },
        {
          name: "description",
          content: "\u4E0E AI \u89D2\u8272\u8FDB\u884C\u5BF9\u8BDD\u4F1A\u8BDD\uFF0C\u4F53\u9A8C\u89D2\u8272\u626E\u6F14\u4E92\u52A8"
        }
      ]
    }),
    component: j(vs, "component")
  });
  _s = () => p(() => Promise.resolve().then(() => ct), void 0);
  Yt = g("/_layout-game/_silly-tavern/plaza/group-chat")({
    head: () => ({
      meta: [
        {
          title: "\u7FA4\u804A\u5E7F\u573A | Group Chat Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u7BA1\u7406\u4F60\u7684\u7FA4\u804A\u4F1A\u8BDD"
        }
      ]
    }),
    component: j(_s, "component")
  });
  Ns = () => p(() => Promise.resolve().then(() => it), void 0);
  Zt = g("/_layout-game/_silly-tavern/plaza/dnd")({
    head: () => ({
      meta: [
        {
          title: "DnD \u5192\u9669\u5E7F\u573A | DnD Adventures"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u7BA1\u7406\u4F60\u7684 DnD \u684C\u6E38\u5192\u9669\u4F1A\u8BDD"
        }
      ]
    }),
    component: j(Ns, "component")
  });
  ys = () => p(() => Promise.resolve().then(() => mt), void 0);
  ea = g("/_layout-game/_silly-tavern/plaza/characters")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5361\u5E7F\u573A | Character Cards Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u89D2\u8272\u5361\uFF0C\u4E0E AI \u89D2\u8272\u5F00\u59CB\u5BF9\u8BDD\u548C\u89D2\u8272\u626E\u6F14"
        }
      ]
    }),
    component: j(ys, "component")
  });
  bs = () => p(() => Promise.resolve().then(() => pt), void 0);
  sa = g("/_layout-game/_silly-tavern/plaza/challenges")({
    head: () => ({
      meta: [
        {
          title: "\u6311\u6218\u5361\u5E7F\u573A | Challenge Cards Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u6311\u6218\u5361\uFF0C\u4F53\u9A8C\u4E0D\u540C\u7684 AI \u89D2\u8272\u626E\u6F14\u6311\u6218\u6A21\u5F0F"
        }
      ]
    }),
    component: j(bs, "component")
  });
  Cs = () => p(() => Promise.resolve().then(() => ut), void 0);
  ta = g("/_layout-game/_silly-tavern/create_/group-chat")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA\u7FA4\u804A | Create Group Chat"
        },
        {
          name: "description",
          content: "\u9009\u62E9 AI \u89D2\u8272\u521B\u5EFA\u7FA4\u804A\u4F1A\u8BDD"
        }
      ]
    }),
    component: j(Cs, "component")
  });
  ws = () => p(() => Promise.resolve().then(() => jt), void 0);
  aa = g("/_layout-game/_silly-tavern/create_/dnd")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA DnD \u5192\u9669 | Create DnD Adventure"
        },
        {
          name: "description",
          content: "\u914D\u7F6E\u4E16\u754C\u8BBE\u5B9A\u548C\u5192\u9669\u89D2\u8272\uFF0C\u5F00\u542F\u4E00\u6BB5 DnD \u684C\u6E38\u98CE\u683C\u7684\u591A\u4EBA\u5192\u9669"
        }
      ]
    }),
    component: j(ws, "component")
  });
  Ss = () => p(() => Promise.resolve().then(() => vt), void 0);
  na = g("/_layout-game/_silly-tavern/create_/character")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA\u89D2\u8272\u5361 | Create Character Card"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u65B0\u7684 AI \u89D2\u8272\u5361\uFF0C\u5B9A\u4E49\u4EBA\u683C\u3001\u80CC\u666F\u548C\u5BF9\u8BDD\u98CE\u683C"
        }
      ]
    }),
    component: j(Ss, "component")
  });
  $s = () => p(() => Promise.resolve().then(() => Nt), void 0);
  ra = g("/_layout-game/_silly-tavern/create_/challenge")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA\u6311\u6218\u5361 | Create Challenge Card"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u65B0\u7684\u6311\u6218\u5361\uFF0C\u8BBE\u5B9A\u4E16\u754C\u53D8\u91CF\u3001\u6210\u5C31\u76EE\u6807\u548C DM \u5F15\u5BFC\u89C4\u5219"
        }
      ]
    }),
    component: j($s, "component")
  });
  Is = () => p(() => Promise.resolve().then(() => bt), void 0);
  oa = g("/_layout-game/_silly-tavern/config/settings")({
    head: () => ({
      meta: [
        {
          title: "\u5E94\u7528\u8BBE\u7F6E | Application Settings"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u5E94\u7528\u7684\u57FA\u672C\u914D\u7F6E\u3001\u504F\u597D\u8BBE\u7F6E\u548C\u7528\u6237\u9009\u9879"
        }
      ]
    }),
    component: j(Is, "component")
  });
  Ps = () => p(() => Promise.resolve().then(() => wt), void 0);
  ca = g("/_layout-game/_silly-tavern/config/overview")({
    head: () => ({
      meta: [
        {
          title: "\u914D\u7F6E\u7BA1\u7406\u6982\u89C8 | Configuration Overview"
        },
        {
          name: "description",
          content: "\u914D\u7F6E\u7BA1\u7406\u4E2D\u5FC3\u6982\u89C8\uFF0C\u5C55\u793A\u6240\u6709\u53EF\u914D\u7F6E\u7684\u9879\u76EE\u548C\u8BBE\u7F6E"
        }
      ]
    }),
    component: j(Ps, "component")
  });
  Ds = () => p(() => Promise.resolve().then(() => $t), void 0);
  Os = g("/_layout-game/_silly-tavern/config/llm")({
    head: () => ({
      meta: [
        {
          title: "LLM \u914D\u7F6E | LLM Configuration"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u5927\u8BED\u8A00\u6A21\u578B\u914D\u7F6E\uFF0C\u5305\u62EC API \u5BC6\u94A5\u3001\u6A21\u578B\u9009\u62E9\u548C\u8C03\u7528\u53C2\u6570"
        }
      ]
    }),
    component: j(Ds, "component")
  });
  zs = () => p(() => Promise.resolve().then(() => Pt), void 0);
  Rs = g("/_layout-game/_silly-tavern/characters_/$characterId")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u8BE6\u60C5 | Character Details"
        },
        {
          name: "description",
          content: "\u67E5\u770B\u89D2\u8272\u5361\u8BE6\u60C5\u3001\u4F1A\u8BDD\u5386\u53F2\u548C\u7BA1\u7406\u89D2\u8272\u8BBE\u7F6E"
        }
      ]
    }),
    component: j(zs, "component")
  });
  ks = () => p(() => Promise.resolve().then(() => Ot), void 0);
  Ts = g("/_layout-game/_silly-tavern/challenges_/$challengeId")({
    head: () => ({
      meta: [
        {
          title: "\u6311\u6218\u8BE6\u60C5 | Challenge Details"
        },
        {
          name: "description",
          content: "\u67E5\u770B\u6311\u6218\u5361\u8BE6\u60C5\u3001\u89C4\u5219\u8BBE\u7F6E\u548C\u76F8\u5173\u4F1A\u8BDD\u8BB0\u5F55"
        }
      ]
    }),
    component: j(ks, "component")
  });
  As = () => p(() => Promise.resolve().then(() => Rt), void 0);
  Es = g("/_layout-game/_silly-tavern/characters_/$characterId_/edit")({
    head: () => ({
      meta: [
        {
          title: "\u7F16\u8F91\u89D2\u8272\u5361 | Edit Character Card"
        },
        {
          name: "description",
          content: "\u7F16\u8F91\u73B0\u6709\u89D2\u8272\u5361\u7684\u5C5E\u6027\u3001\u80CC\u666F\u548C\u5BF9\u8BDD\u8BBE\u7F6E"
        }
      ]
    }),
    component: j(As, "component")
  });
  Ls = Oe;
  Ms = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ls
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Fs() {
    return e.jsxs("div", {
      className: "flex flex-col h-full overflow-hidden",
      children: [
        e.jsx("header", {
          className: "h-14 border-b bg-background flex items-center px-4 justify-between shrink-0",
          children: e.jsxs("div", {
            className: "flex items-center gap-2",
            children: [
              e.jsxs(v, {
                to: "/",
                className: "flex items-center gap-2 font-bold text-lg mr-6",
                children: [
                  e.jsx(q, {
                    className: "w-5 h-5 text-primary"
                  }),
                  e.jsx("span", {
                    children: "SillyTavern Lite"
                  })
                ]
              }),
              e.jsxs("nav", {
                className: "flex items-center gap-1",
                children: [
                  e.jsxs(v, {
                    to: "/plaza/characters",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(H, {
                        className: "w-4 h-4"
                      }),
                      "\u5E7F\u573A"
                    ]
                  }),
                  e.jsxs(v, {
                    to: "/create",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(je, {
                        className: "w-4 h-4"
                      }),
                      "\u5DE5\u574A"
                    ]
                  }),
                  e.jsxs(v, {
                    to: "/session",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(Ee, {
                        className: "w-4 h-4"
                      }),
                      "\u4F1A\u8BDD"
                    ]
                  })
                ]
              })
            ]
          })
        }),
        e.jsx("main", {
          className: "grow overflow-auto flex flex-col",
          children: e.jsx(W, {})
        })
      ]
    });
  }
  const Vs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Fs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Gs() {
    const t = C();
    return f.useEffect(() => {
      const r = setTimeout(() => {
        t({
          to: "/plaza/characters"
        });
      }, 3e3);
      return () => clearTimeout(r);
    }, [
      t
    ]), e.jsxs("div", {
      className: "flex flex-col items-center justify-center h-full bg-background space-y-6",
      children: [
        e.jsxs("div", {
          className: "relative",
          children: [
            e.jsx("div", {
              className: "absolute -inset-1 rounded-full bg-primary/20 blur-xl animate-pulse"
            }),
            e.jsx(q, {
              className: "w-20 h-20 text-primary relative"
            })
          ]
        }),
        e.jsxs("div", {
          className: "text-center space-y-2",
          children: [
            e.jsx("h1", {
              className: "text-4xl font-bold tracking-tight",
              children: "SillyTavern Lite"
            }),
            e.jsx("p", {
              className: "text-muted-foreground",
              children: "\u6B22\u8FCE\u56DE\u6765\uFF0C\u521B\u4F5C\u8005"
            })
          ]
        }),
        e.jsx("div", {
          className: "flex items-center gap-2 text-sm text-muted-foreground animate-bounce",
          children: e.jsx("span", {
            children: "\u5373\u5C06\u8FDB\u5165\u5E7F\u573A..."
          })
        })
      ]
    });
  }
  const Us = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Gs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Bs() {
    const t = C(), { sessionId: r } = Re({
      strict: false
    }), { data: i = [] } = y((c) => c.from({
      s: A
    })), { data: a = [] } = y((c) => c.from({
      c: L
    })), s = (c) => {
      t({
        to: "/session/$sessionId",
        params: {
          sessionId: c.id
        }
      });
    }, l = () => {
      t({
        to: "/plaza/characters"
      });
    }, x = async (c) => {
      try {
        await N.sessions.delete(c.id);
      } catch (n) {
        console.error("Failed to delete session:", n);
      }
    };
    return e.jsxs("div", {
      className: "flex h-full overflow-hidden",
      children: [
        e.jsx(Ge, {
          sessions: i,
          characters: a,
          activeSessionId: r,
          onSessionSelect: s,
          onNewSession: l,
          onSessionDelete: x
        }),
        e.jsx("div", {
          className: "grow overflow-hidden relative",
          children: e.jsx(W, {})
        })
      ]
    });
  }
  const Ws = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Bs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function qs() {
    const t = ke(), r = t.pathname.includes("challenges") ? "challenges" : t.pathname.includes("group-chat") ? "group-chat" : t.pathname.includes("dnd") ? "dnd" : "characters";
    return e.jsxs("div", {
      className: "flex flex-col h-full overflow-y-auto",
      children: [
        e.jsx("div", {
          className: "border-b px-6 py-2 bg-muted/20",
          children: e.jsx(ie, {
            value: r,
            className: "w-fit",
            children: e.jsxs(de, {
              children: [
                e.jsx(v, {
                  to: "/plaza/characters",
                  children: e.jsx(P, {
                    value: "characters",
                    children: "\u89D2\u8272\u5361"
                  })
                }),
                e.jsx(v, {
                  to: "/plaza/challenges",
                  children: e.jsx(P, {
                    value: "challenges",
                    className: "cursor-pointer",
                    children: "\u6311\u6218\u5361"
                  })
                }),
                e.jsx(v, {
                  to: "/plaza/dnd",
                  children: e.jsx(P, {
                    value: "dnd",
                    className: "cursor-pointer",
                    children: "DnD \u5192\u9669"
                  })
                }),
                e.jsx(v, {
                  to: "/plaza/group-chat",
                  children: e.jsx(P, {
                    value: "group-chat",
                    className: "cursor-pointer",
                    children: "\u7FA4\u804A"
                  })
                })
              ]
            })
          })
        }),
        e.jsx("div", {
          className: "p-6",
          children: e.jsx(W, {})
        })
      ]
    });
  }
  const Hs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: qs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Js() {
    return e.jsxs("div", {
      className: "p-6 max-w-4xl mx-auto space-y-8",
      children: [
        e.jsxs("div", {
          className: "space-y-2",
          children: [
            e.jsxs("h1", {
              className: "text-3xl font-bold flex items-center gap-2",
              children: [
                e.jsx(je, {
                  className: "w-8 h-8 text-primary"
                }),
                "\u521B\u4F5C\u8005\u5DE5\u574A"
              ]
            }),
            e.jsx("p", {
              className: "text-muted-foreground",
              children: "\u5728\u8FD9\u91CC\u521B\u5EFA\u548C\u7BA1\u7406\u4F60\u7684\u89D2\u8272\u5361\u3001\u6311\u6218\u8BBE\u5B9A\u4E0E\u5192\u9669\u3002"
            })
          ]
        }),
        e.jsxs("div", {
          className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",
          children: [
            e.jsx(v, {
              to: "/create/character",
              children: e.jsxs(w, {
                className: "hover:border-primary transition-colors cursor-pointer group h-full",
                children: [
                  e.jsxs(D, {
                    children: [
                      e.jsx(H, {
                        className: "w-10 h-10 mb-2 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(O, {
                        children: "\u65B0\u89D2\u8272\u5361"
                      }),
                      e.jsx(z, {
                        children: "\u5B9A\u4E49\u89D2\u8272\u7684\u4EBA\u683C\u3001\u80CC\u666F\u3001\u5F00\u573A\u767D\u548C\u5BF9\u8BDD\u98CE\u683C\u3002"
                      })
                    ]
                  }),
                  e.jsx(S, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-primary",
                      children: [
                        "\u7ACB\u5373\u5F00\u59CB ",
                        e.jsx(M, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            }),
            e.jsx(v, {
              to: "/create/challenge",
              children: e.jsxs(w, {
                className: "hover:border-primary transition-colors cursor-pointer group h-full",
                children: [
                  e.jsxs(D, {
                    children: [
                      e.jsx(fe, {
                        className: "w-10 h-10 mb-2 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(O, {
                        children: "\u65B0\u6311\u6218\u5361"
                      }),
                      e.jsx(z, {
                        children: "\u8BBE\u5B9A\u4E16\u754C\u53D8\u91CF\u3001\u6210\u5C31\u76EE\u6807\u548C DM \u7684\u5F15\u5BFC\u89C4\u5219\u3002"
                      })
                    ]
                  }),
                  e.jsx(S, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-primary",
                      children: [
                        "\u7ACB\u5373\u5F00\u59CB ",
                        e.jsx(M, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            }),
            e.jsx(v, {
              to: "/create/dnd",
              children: e.jsxs(w, {
                className: "hover:border-amber-500/50 transition-colors cursor-pointer group h-full",
                children: [
                  e.jsxs(D, {
                    children: [
                      e.jsx(V, {
                        className: "w-10 h-10 mb-2 text-amber-600 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(O, {
                        children: "DnD \u5192\u9669"
                      }),
                      e.jsx(z, {
                        children: "\u914D\u7F6E\u5192\u9669\u4E16\u754C\u3001\u9009\u62E9\u89D2\u8272\u56E2\u961F\uFF0C\u5F00\u59CB\u684C\u6E38\u98CE\u683C\u7684\u591A\u4EBA\u5192\u9669\u3002"
                      })
                    ]
                  }),
                  e.jsx(S, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-amber-600",
                      children: [
                        "\u7ACB\u5373\u5F00\u59CB ",
                        e.jsx(M, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            }),
            e.jsx(v, {
              to: "/create/group-chat",
              children: e.jsxs(w, {
                className: "hover:border-violet-500/50 transition-colors cursor-pointer group h-full",
                children: [
                  e.jsxs(D, {
                    children: [
                      e.jsx(G, {
                        className: "w-10 h-10 mb-2 text-violet-500 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(O, {
                        children: "\u7FA4\u804A"
                      }),
                      e.jsx(z, {
                        children: "\u9009\u62E9\u591A\u4E2A AI \u89D2\u8272\uFF0C\u5F00\u59CB\u81EA\u7531\u7FA4\u804A\u5BF9\u8BDD\u3002"
                      })
                    ]
                  }),
                  e.jsx(S, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-violet-500",
                      children: [
                        "\u7ACB\u5373\u5F00\u59CB ",
                        e.jsx(M, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            })
          ]
        })
      ]
    });
  }
  const Qs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Js
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ks() {
    const [t, r] = f.useState(false), i = e.jsxs(e.Fragment, {
      children: [
        e.jsx("h2", {
          className: "text-lg font-semibold mb-4",
          children: "\u914D\u7F6E\u7BA1\u7406"
        }),
        e.jsxs("ul", {
          className: "space-y-2",
          children: [
            e.jsx("li", {
              children: e.jsx(v, {
                to: "/config/overview",
                className: "block p-2 rounded hover:bg-foreground/5 md:hover:bg-background",
                onClick: () => r(false),
                children: "\u6982\u89C8"
              })
            }),
            e.jsx("li", {
              children: e.jsx(v, {
                to: "/config/llm",
                className: "block p-2 rounded hover:bg-foreground/5 md:hover:bg-background",
                onClick: () => r(false),
                children: "LLM \u914D\u7F6E"
              })
            })
          ]
        })
      ]
    });
    return e.jsxs("div", {
      className: "flex h-full",
      children: [
        e.jsx("nav", {
          className: "hidden md:block w-64 p-4 bg-foreground/5 overflow-y-auto",
          children: i
        }),
        e.jsxs(as, {
          open: t,
          onOpenChange: r,
          children: [
            e.jsx(ns, {
              asChild: true,
              children: e.jsx(h, {
                variant: "outline",
                size: "icon",
                className: "md:hidden fixed bottom-8 left-8 rounded-full shadow-lg z-50",
                children: e.jsx(Le, {
                  className: "h-4 w-4"
                })
              })
            }),
            e.jsx(rs, {
              side: "left",
              className: "w-64 p-4 overflow-y-auto",
              children: i
            })
          ]
        }),
        e.jsx("main", {
          className: "flex-1 p-4 lg:px-8 xl:px-12 overflow-auto",
          children: e.jsx(W, {})
        })
      ]
    });
  }
  const Xs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ks
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ys() {
    return e.jsx(Te, {
      to: "/config/overview"
    });
  }
  const Zs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ys
  }, Symbol.toStringTag, {
    value: "Module"
  })), et = f.lazy(() => p(() => import("./app-libs-for-silly-tavern-B25rjgZe.js").then((t) => t.r), __vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then((t) => ({
    default: t.SessionMainForChat
  }))), st = f.lazy(() => p(() => import("./app-libs-for-silly-tavern-B25rjgZe.js").then((t) => t.s), __vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then((t) => ({
    default: t.SessionMainForChallenge
  }))), tt = f.lazy(() => p(() => import("./app-libs-for-silly-tavern-B25rjgZe.js").then((t) => t.t), __vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then((t) => ({
    default: t.SessionMainForDnd
  }))), at = f.lazy(() => p(() => import("./app-libs-for-silly-tavern-B25rjgZe.js").then((t) => t.u), __vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then((t) => ({
    default: t.SessionMainForGroupChat
  })));
  function nt() {
    var _a;
    const { sessionId: t } = ge.useParams(), r = ge.useSearch(), { data: i = [] } = y((l) => l.from({
      s: A
    }).where(({ s: x }) => Ae(x.id, t))), s = ((_a = i[0]) == null ? void 0 : _a.mode) || r.mode;
    return e.jsx(f.Suspense, {
      fallback: e.jsx("div", {
        className: "flex flex-col items-center justify-center h-full text-muted-foreground space-y-4",
        children: e.jsx("p", {
          children: "\u52A0\u8F7D\u4E2D..."
        })
      }),
      children: s === "dnd" ? e.jsx(tt, {
        sessionId: t
      }) : s === "group-chat" ? e.jsx(at, {
        sessionId: t
      }) : s === "challenge" ? e.jsx(st, {
        sessionId: t
      }) : e.jsx(et, {
        sessionId: t
      })
    });
  }
  const rt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: nt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function ot() {
    const t = C(), { data: r = [] } = y((s) => s.from({
      s: A
    })), i = r.filter((s) => s.mode === "group-chat").sort((s, l) => l.updatedAt - s.updatedAt), a = async (s) => {
      try {
        await N.sessions.delete(s), m.success("\u7FA4\u804A\u4F1A\u8BDD\u5DF2\u5220\u9664");
      } catch (l) {
        console.error("\u5220\u9664\u5931\u8D25:", l), m.error("\u5220\u9664\u5931\u8D25");
      }
    };
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs("div", {
              children: [
                e.jsxs("h2", {
                  className: "text-2xl font-bold flex items-center gap-2",
                  children: [
                    e.jsx(G, {
                      className: "w-6 h-6 text-violet-500"
                    }),
                    "\u7FA4\u804A"
                  ]
                }),
                e.jsx("p", {
                  className: "text-sm text-muted-foreground mt-1",
                  children: "\u548C\u591A\u4E2A AI \u89D2\u8272\u81EA\u7531\u804A\u5929"
                })
              ]
            }),
            e.jsxs(h, {
              type: "button",
              onClick: () => t({
                to: "/create/group-chat"
              }),
              className: "gap-2",
              children: [
                e.jsx(T, {
                  className: "w-4 h-4"
                }),
                "\u521B\u5EFA\u7FA4\u804A"
              ]
            })
          ]
        }),
        i.length > 0 ? e.jsx("div", {
          className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",
          children: i.map((s) => {
            var _a, _b, _c;
            const l = ((_a = s.modeConfig) == null ? void 0 : _a.topic) || "\u7FA4\u804A", x = ((_b = s.modeConfig) == null ? void 0 : _b.participantSnapshots) || [], c = ((_c = s.modeState) == null ? void 0 : _c.messageCount) || 0;
            return e.jsxs(w, {
              className: "cursor-pointer hover:border-violet-500/50 transition-colors group relative",
              onClick: () => t({
                to: "/session/$sessionId",
                params: {
                  sessionId: s.id
                }
              }),
              children: [
                e.jsx(D, {
                  className: "pb-3",
                  children: e.jsxs("div", {
                    className: "flex items-start justify-between",
                    children: [
                      e.jsxs("div", {
                        className: "flex items-center gap-2",
                        children: [
                          e.jsx("div", {
                            className: "w-10 h-10 rounded-xl bg-violet-500/10 flex items-center justify-center border border-violet-500/20",
                            children: e.jsx(G, {
                              className: "w-5 h-5 text-violet-600"
                            })
                          }),
                          e.jsxs("div", {
                            children: [
                              e.jsx(O, {
                                className: "text-base",
                                children: l
                              }),
                              e.jsxs(z, {
                                className: "text-[10px]",
                                children: [
                                  c,
                                  " \u6761\u6D88\u606F"
                                ]
                              })
                            ]
                          })
                        ]
                      }),
                      e.jsxs(Q, {
                        children: [
                          e.jsx(K, {
                            asChild: true,
                            children: e.jsx(h, {
                              type: "button",
                              variant: "ghost",
                              size: "icon",
                              className: "h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",
                              onClick: (n) => n.stopPropagation(),
                              children: e.jsx(J, {
                                className: "w-3.5 h-3.5 text-muted-foreground hover:text-destructive"
                              })
                            })
                          }),
                          e.jsxs(X, {
                            children: [
                              e.jsxs(Y, {
                                children: [
                                  e.jsx(Z, {
                                    children: "\u786E\u8BA4\u5220\u9664"
                                  }),
                                  e.jsxs(ee, {
                                    children: [
                                      "\u786E\u5B9A\u8981\u5220\u9664\u7FA4\u804A\u300C",
                                      l,
                                      "\u300D\u5417\uFF1F\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u3002"
                                    ]
                                  })
                                ]
                              }),
                              e.jsxs(se, {
                                children: [
                                  e.jsx(te, {
                                    children: "\u53D6\u6D88"
                                  }),
                                  e.jsx(ae, {
                                    className: "bg-destructive hover:bg-destructive/90",
                                    onClick: (n) => {
                                      n.stopPropagation(), a(s.id);
                                    },
                                    children: "\u786E\u8BA4\u5220\u9664"
                                  })
                                ]
                              })
                            ]
                          })
                        ]
                      })
                    ]
                  })
                }),
                e.jsxs(S, {
                  className: "pt-0",
                  children: [
                    e.jsxs("div", {
                      className: "flex items-center gap-2 mb-3",
                      children: [
                        e.jsx(H, {
                          className: "w-3.5 h-3.5 text-muted-foreground"
                        }),
                        e.jsxs("div", {
                          className: "flex flex-wrap gap-1",
                          children: [
                            x.slice(0, 4).map((n) => e.jsx(R, {
                              variant: "secondary",
                              className: "text-[9px] px-1.5 h-4",
                              children: n.name
                            }, n.id)),
                            x.length > 4 && e.jsxs(R, {
                              variant: "secondary",
                              className: "text-[9px] px-1.5 h-4",
                              children: [
                                "+",
                                x.length - 4
                              ]
                            })
                          ]
                        })
                      ]
                    }),
                    e.jsxs("div", {
                      className: "flex items-center justify-between",
                      children: [
                        e.jsx("span", {
                          className: "text-[10px] text-muted-foreground",
                          children: new Date(s.updatedAt).toLocaleDateString()
                        }),
                        e.jsxs("div", {
                          className: "flex items-center gap-1 text-primary text-xs font-medium",
                          children: [
                            e.jsx(ve, {
                              className: "w-3.5 h-3.5"
                            }),
                            "\u7EE7\u7EED\u804A\u5929"
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            }, s.id);
          })
        }) : e.jsx(w, {
          className: "border-dashed",
          children: e.jsxs(S, {
            className: "py-16 text-center",
            children: [
              e.jsx(G, {
                className: "w-12 h-12 text-muted-foreground/20 mx-auto mb-4"
              }),
              e.jsx("p", {
                className: "text-muted-foreground mb-4",
                children: "\u8FD8\u6CA1\u6709\u7FA4\u804A\u4F1A\u8BDD"
              }),
              e.jsxs(h, {
                type: "button",
                variant: "outline",
                className: "gap-2",
                onClick: () => t({
                  to: "/create/group-chat"
                }),
                children: [
                  e.jsx(T, {
                    className: "w-4 h-4"
                  }),
                  "\u521B\u5EFA\u7B2C\u4E00\u4E2A\u7FA4\u804A"
                ]
              })
            ]
          })
        })
      ]
    });
  }
  const ct = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: ot
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function lt() {
    const t = C(), { data: r = [] } = y((s) => s.from({
      s: A
    })), i = r.filter((s) => s.mode === "dnd").sort((s, l) => l.updatedAt - s.updatedAt), a = async (s) => {
      try {
        await N.sessions.delete(s), m.success("\u5192\u9669\u4F1A\u8BDD\u5DF2\u5220\u9664");
      } catch (l) {
        console.error("\u5220\u9664\u5931\u8D25:", l), m.error("\u5220\u9664\u5931\u8D25");
      }
    };
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs("div", {
              children: [
                e.jsxs("h2", {
                  className: "text-2xl font-bold flex items-center gap-2",
                  children: [
                    e.jsx(V, {
                      className: "w-6 h-6 text-amber-500"
                    }),
                    "DnD \u5192\u9669"
                  ]
                }),
                e.jsx("p", {
                  className: "text-sm text-muted-foreground mt-1",
                  children: "\u7BA1\u7406\u4F60\u7684\u684C\u6E38\u98CE\u683C\u591A\u4EBA\u5192\u9669\u4F1A\u8BDD"
                })
              ]
            }),
            e.jsxs(h, {
              type: "button",
              onClick: () => t({
                to: "/create/dnd"
              }),
              className: "gap-2",
              children: [
                e.jsx(T, {
                  className: "w-4 h-4"
                }),
                "\u521B\u5EFA\u65B0\u5192\u9669"
              ]
            })
          ]
        }),
        i.length > 0 ? e.jsx("div", {
          className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",
          children: i.map((s) => {
            var _a, _b, _c, _d, _e2;
            const l = ((_b = (_a = s.modeConfig) == null ? void 0 : _a.worldSnapshot) == null ? void 0 : _b.name) || "\u672A\u547D\u540D\u5192\u9669", x = ((_c = s.modeConfig) == null ? void 0 : _c.gameMode) || "standard", c = ((_d = s.modeConfig) == null ? void 0 : _d.playerCharacterSnapshots) || [], n = ((_e2 = s.modeState) == null ? void 0 : _e2.currentRound) || 1;
            return e.jsxs(w, {
              className: "cursor-pointer hover:border-amber-500/50 transition-colors group relative",
              onClick: () => t({
                to: "/session/$sessionId",
                params: {
                  sessionId: s.id
                }
              }),
              children: [
                e.jsx(D, {
                  className: "pb-3",
                  children: e.jsxs("div", {
                    className: "flex items-start justify-between",
                    children: [
                      e.jsxs("div", {
                        className: "flex items-center gap-2",
                        children: [
                          e.jsx("div", {
                            className: "w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center border border-amber-500/20",
                            children: e.jsx(V, {
                              className: "w-5 h-5 text-amber-600"
                            })
                          }),
                          e.jsxs("div", {
                            children: [
                              e.jsx(O, {
                                className: "text-base",
                                children: l
                              }),
                              e.jsxs(z, {
                                className: "text-[10px]",
                                children: [
                                  "\u56DE\u5408 ",
                                  n,
                                  " \xB7 ",
                                  x
                                ]
                              })
                            ]
                          })
                        ]
                      }),
                      e.jsxs(Q, {
                        children: [
                          e.jsx(K, {
                            asChild: true,
                            children: e.jsx(h, {
                              type: "button",
                              variant: "ghost",
                              size: "icon",
                              className: "h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",
                              onClick: (o) => o.stopPropagation(),
                              children: e.jsx(J, {
                                className: "w-3.5 h-3.5 text-muted-foreground hover:text-destructive"
                              })
                            })
                          }),
                          e.jsxs(X, {
                            children: [
                              e.jsxs(Y, {
                                children: [
                                  e.jsx(Z, {
                                    children: "\u786E\u8BA4\u5220\u9664"
                                  }),
                                  e.jsxs(ee, {
                                    children: [
                                      "\u786E\u5B9A\u8981\u5220\u9664\u5192\u9669\u300C",
                                      l,
                                      "\u300D\u5417\uFF1F\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u3002"
                                    ]
                                  })
                                ]
                              }),
                              e.jsxs(se, {
                                children: [
                                  e.jsx(te, {
                                    children: "\u53D6\u6D88"
                                  }),
                                  e.jsx(ae, {
                                    className: "bg-destructive hover:bg-destructive/90",
                                    onClick: (o) => {
                                      o.stopPropagation(), a(s.id);
                                    },
                                    children: "\u786E\u8BA4\u5220\u9664"
                                  })
                                ]
                              })
                            ]
                          })
                        ]
                      })
                    ]
                  })
                }),
                e.jsxs(S, {
                  className: "pt-0",
                  children: [
                    e.jsxs("div", {
                      className: "flex items-center gap-2 mb-3",
                      children: [
                        e.jsx(H, {
                          className: "w-3.5 h-3.5 text-muted-foreground"
                        }),
                        e.jsxs("div", {
                          className: "flex flex-wrap gap-1",
                          children: [
                            c.slice(0, 4).map((o) => e.jsx(R, {
                              variant: "secondary",
                              className: "text-[9px] px-1.5 h-4",
                              children: o.name
                            }, o.id)),
                            c.length > 4 && e.jsxs(R, {
                              variant: "secondary",
                              className: "text-[9px] px-1.5 h-4",
                              children: [
                                "+",
                                c.length - 4
                              ]
                            })
                          ]
                        })
                      ]
                    }),
                    e.jsxs("div", {
                      className: "flex items-center justify-between",
                      children: [
                        e.jsx("span", {
                          className: "text-[10px] text-muted-foreground",
                          children: new Date(s.updatedAt).toLocaleDateString()
                        }),
                        e.jsxs("div", {
                          className: "flex items-center gap-1 text-primary text-xs font-medium",
                          children: [
                            e.jsx(ve, {
                              className: "w-3.5 h-3.5"
                            }),
                            "\u7EE7\u7EED\u5192\u9669"
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            }, s.id);
          })
        }) : e.jsx(w, {
          className: "border-dashed",
          children: e.jsxs(S, {
            className: "py-16 text-center",
            children: [
              e.jsx(V, {
                className: "w-12 h-12 text-muted-foreground/20 mx-auto mb-4"
              }),
              e.jsx("p", {
                className: "text-muted-foreground mb-4",
                children: "\u8FD8\u6CA1\u6709 DnD \u5192\u9669\u4F1A\u8BDD"
              }),
              e.jsxs(h, {
                type: "button",
                variant: "outline",
                className: "gap-2",
                onClick: () => t({
                  to: "/create/dnd"
                }),
                children: [
                  e.jsx(T, {
                    className: "w-4 h-4"
                  }),
                  "\u521B\u5EFA\u7B2C\u4E00\u4E2A\u5192\u9669"
                ]
              })
            ]
          })
        })
      ]
    });
  }
  const it = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: lt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function dt() {
    const t = C(), [r, i] = f.useState(false), { data: a = [] } = y((o) => o.from({
      c: L
    })), s = (o) => {
      t({
        to: "/characters/$characterId",
        params: {
          characterId: o.id
        }
      });
    }, l = (o) => {
      t({
        to: "/characters/$characterId",
        params: {
          characterId: o.id
        }
      });
    }, x = async (o) => {
      try {
        await N.characters.add(o), m.success(`\u6210\u529F\u5BFC\u5165\u89D2\u8272: ${o.name}`);
      } catch (b) {
        m.error("\u5BFC\u5165\u5931\u8D25"), console.error(b);
      }
    }, c = async () => {
      try {
        let o = 0;
        for (const b of We) try {
          await N.characters.add(b), o++;
        } catch (E) {
          console.error(`Failed to import preset ${b.name}:`, E);
        }
        o > 0 ? m.success(`\u6210\u529F\u5BFC\u5165 ${o} \u4E2A\u89D2\u8272\u9884\u8BBE`) : m.error("\u6CA1\u6709\u627E\u5230\u53EF\u5BFC\u5165\u7684\u89D2\u8272\u9884\u8BBE");
      } catch (o) {
        m.error("\u5BFC\u5165\u9884\u8BBE\u5931\u8D25"), console.error(o);
      }
    }, n = e.jsxs("div", {
      className: "flex items-center gap-2",
      children: [
        e.jsxs(h, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: () => i(true),
          children: [
            e.jsx(_e, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u89D2\u8272"
          ]
        }),
        e.jsxs(h, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: c,
          children: [
            e.jsx(q, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u9884\u8BBE"
          ]
        }),
        e.jsx(Be, {
          characters: a
        }),
        e.jsxs(h, {
          variant: "default",
          size: "sm",
          className: "flex items-center gap-2",
          onClick: () => t({
            to: "/create/character"
          }),
          type: "button",
          children: [
            e.jsx(T, {
              className: "w-4 h-4"
            }),
            "\u65B0\u5EFA\u89D2\u8272"
          ]
        }),
        e.jsx(Ce, {
          open: r,
          onOpenChange: i,
          onImport: x
        })
      ]
    });
    return e.jsx(be, {
      items: a,
      title: "\u89D2\u8272\u5217\u8868",
      placeholder: "\u641C\u7D22\u540D\u79F0\u3001\u63CF\u8FF0\u6216\u6807\u7B7E...",
      actions: n,
      getSearchableContent: (o) => `${o.name} ${o.description} ${o.tags.join(" ")}`,
      getTags: (o) => o.tags,
      getId: (o) => o.id,
      renderCard: (o) => e.jsx(Ue, {
        character: o,
        onClick: l,
        onStartSession: s
      })
    });
  }
  const mt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: dt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function ht() {
    const t = C(), [r, i] = f.useState(false), { data: a = [] } = y((n) => n.from({
      c: we
    })), s = (n) => {
      t({
        to: "/challenges/$challengeId",
        params: {
          challengeId: n.id
        }
      });
    }, l = (n) => {
      t({
        to: "/challenges/$challengeId",
        params: {
          challengeId: n.id
        }
      });
    }, x = async () => {
      try {
        let n = 0;
        for (const o of He) try {
          await N.challenges.add(o), n++;
        } catch (b) {
          console.error(`Failed to import preset ${o.name}:`, b);
        }
        n > 0 ? m.success(`\u6210\u529F\u5BFC\u5165 ${n} \u4E2A\u6311\u6218\u9884\u8BBE`) : m.error("\u6CA1\u6709\u627E\u5230\u53EF\u5BFC\u5165\u7684\u6311\u6218\u9884\u8BBE");
      } catch (n) {
        m.error("\u5BFC\u5165\u9884\u8BBE\u5931\u8D25"), console.error(n);
      }
    }, c = e.jsxs("div", {
      className: "flex items-center gap-2",
      children: [
        e.jsxs(h, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: () => i(true),
          children: [
            e.jsx(_e, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u6311\u6218"
          ]
        }),
        e.jsxs(h, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: x,
          children: [
            e.jsx(q, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u9884\u8BBE"
          ]
        }),
        e.jsxs(h, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          children: [
            e.jsx(U, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u51FA\u6240\u6709"
          ]
        }),
        e.jsxs(h, {
          variant: "default",
          size: "sm",
          className: "flex items-center gap-2",
          onClick: () => t({
            to: "/create/challenge"
          }),
          type: "button",
          children: [
            e.jsx(T, {
              className: "w-4 h-4"
            }),
            "\u65B0\u5EFA\u6311\u6218"
          ]
        }),
        e.jsx(Ce, {
          open: r,
          onOpenChange: i,
          onImport: (n) => {
            m.success(`\u6210\u529F\u5BFC\u5165\u6311\u6218: ${n.name}`);
          }
        })
      ]
    });
    return e.jsx("div", {
      className: "relative",
      children: e.jsx(be, {
        items: a,
        title: "\u6311\u6218\u5217\u8868",
        placeholder: "\u641C\u7D22\u540D\u79F0\u3001\u63CF\u8FF0\u6216\u6807\u7B7E...",
        actions: c,
        getSearchableContent: (n) => {
          var _a;
          return `${n.name} ${n.description} ${((_a = n.tags) == null ? void 0 : _a.join(" ")) || ""}`;
        },
        getTags: (n) => n.tags || [],
        getId: (n) => n.id,
        renderCard: (n) => e.jsx(qe, {
          challenge: n,
          onClick: l,
          onStartSession: s
        })
      })
    });
  }
  const pt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: ht
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function xt() {
    return e.jsx("div", {
      className: "p-6",
      children: e.jsx(Je, {})
    });
  }
  const ut = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: xt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function gt() {
    return e.jsx("div", {
      className: "p-6 relative",
      children: e.jsx(Qe, {})
    });
  }
  const jt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: gt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function ft() {
    const t = C(), r = async (a) => {
      if (!a.name) {
        m.error("\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A");
        return;
      }
      try {
        const s = Date.now(), x = {
          id: crypto.randomUUID(),
          name: a.name,
          description: a.description || "",
          personality: a.personality || "",
          scenario: a.scenario || "",
          first_mes: a.first_mes || "",
          mes_example: a.mes_example || "",
          creator_notes: a.creator_notes || "",
          system_prompt: a.system_prompt || "",
          post_history_instructions: a.post_history_instructions || "",
          alternate_greetings: a.alternate_greetings || [],
          tags: a.tags || [],
          extensions: a.extensions || {},
          assets: a.assets,
          avatar: a.avatar,
          imageBase64: a.imageBase64,
          character_book: a.character_book,
          nickname: a.nickname,
          source: a.source,
          creation_date: a.creation_date || s,
          modification_date: a.modification_date || s,
          creator: "User",
          character_version: "1.0",
          group_only_greetings: [],
          createdAt: s,
          updatedAt: s
        };
        await N.characters.add(x);
        const c = x;
        m.success(`\u89D2\u8272 ${c.name} \u5DF2\u521B\u5EFA`), t({
          to: "/plaza/characters"
        });
      } catch (s) {
        m.error("\u521B\u5EFA\u5931\u8D25"), console.error(s);
      }
    }, i = () => {
      t({
        to: "/create"
      });
    };
    return e.jsx("div", {
      className: "p-6 w-full max-w-5xl mx-auto",
      children: e.jsx(Se, {
        className: "w-full",
        onSave: r,
        onCancel: i,
        mode: "create"
      })
    });
  }
  const vt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: ft
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function _t() {
    const t = C(), r = async (a) => {
      try {
        const s = {
          ...a,
          id: Ie(),
          createdAt: Date.now(),
          updatedAt: Date.now()
        };
        await N.challenges.add(s), m.success("\u6311\u6218\u5361\u521B\u5EFA\u6210\u529F"), t({
          to: "/plaza/challenges"
        });
      } catch (s) {
        console.error(s), m.error("\u4FDD\u5B58\u5931\u8D25");
      }
    }, i = () => {
      t({
        to: "/plaza/challenges"
      });
    };
    return e.jsx("div", {
      className: "p-6 relative",
      children: e.jsx(Ke, {
        onSave: r,
        onCancel: i
      })
    });
  }
  const Nt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: _t
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function yt() {
    const t = f.useId(), r = f.useId(), i = f.useId(), a = f.useId(), [s, l] = f.useState({
      appName: "My App",
      enableNotifications: true,
      theme: "auto",
      description: ""
    }), x = () => {
      m.success("\u8BBE\u7F6E\u5DF2\u4FDD\u5B58");
    }, c = (n, o) => {
      l((b) => ({
        ...b,
        [n]: o
      }));
    };
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsx("h1", {
          className: "text-2xl font-bold",
          children: "\u5E94\u7528\u8BBE\u7F6E"
        }),
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u7BA1\u7406\u5E94\u7528\u7684\u57FA\u672C\u914D\u7F6E\u548C\u504F\u597D\u8BBE\u7F6E\u3002"
        }),
        e.jsxs(w, {
          children: [
            e.jsxs(D, {
              children: [
                e.jsx(O, {
                  children: "\u57FA\u672C\u8BBE\u7F6E"
                }),
                e.jsx(z, {
                  children: "\u914D\u7F6E\u5E94\u7528\u7684\u57FA\u672C\u4FE1\u606F\u548C\u884C\u4E3A\u3002"
                })
              ]
            }),
            e.jsxs(S, {
              className: "space-y-4",
              children: [
                e.jsxs("div", {
                  className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                  children: [
                    e.jsxs("div", {
                      className: "space-y-2",
                      children: [
                        e.jsx(F, {
                          htmlFor: t,
                          children: "\u5E94\u7528\u540D\u79F0"
                        }),
                        e.jsx(xe, {
                          id: t,
                          value: s.appName,
                          onChange: (n) => c("appName", n.target.value)
                        })
                      ]
                    }),
                    e.jsxs("div", {
                      className: "space-y-2",
                      children: [
                        e.jsx(F, {
                          htmlFor: r,
                          children: "\u4E3B\u9898"
                        }),
                        e.jsx(xe, {
                          id: r,
                          value: s.theme,
                          onChange: (n) => c("theme", n.target.value)
                        })
                      ]
                    })
                  ]
                }),
                e.jsxs("div", {
                  className: "space-y-2",
                  children: [
                    e.jsx(F, {
                      htmlFor: i,
                      children: "\u63CF\u8FF0"
                    }),
                    e.jsx(os, {
                      id: i,
                      value: s.description,
                      onChange: (n) => c("description", n.target.value),
                      placeholder: "\u8F93\u5165\u5E94\u7528\u63CF\u8FF0..."
                    })
                  ]
                }),
                e.jsxs("div", {
                  className: "flex items-center space-x-2",
                  children: [
                    e.jsx(cs, {
                      id: a,
                      checked: s.enableNotifications,
                      onCheckedChange: (n) => c("enableNotifications", n)
                    }),
                    e.jsx(F, {
                      htmlFor: a,
                      children: "\u542F\u7528\u901A\u77E5"
                    })
                  ]
                }),
                e.jsx(h, {
                  onClick: x,
                  children: "\u4FDD\u5B58\u8BBE\u7F6E"
                })
              ]
            })
          ]
        })
      ]
    });
  }
  const bt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: yt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ct() {
    const t = [
      {
        name: "LLM \u914D\u7F6E",
        path: "/config/llm",
        description: "\u7BA1\u7406 LLM \u6A21\u578B\u914D\u7F6E\u3001API \u5BC6\u94A5\u548C\u8C03\u7528\u53C2\u6570\u3002"
      }
    ];
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsx("h1", {
          className: "text-2xl font-bold",
          children: "\u914D\u7F6E\u7BA1\u7406\u6982\u89C8"
        }),
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u8FD9\u91CC\u60A8\u53EF\u4EE5\u7BA1\u7406\u672C\u5E94\u7528\u4E2D\u7684\u5404\u79CD\u914D\u7F6E\uFF0C\u5305\u62EC\u5E94\u7528\u8BBE\u7F6E\u3001\u7528\u6237\u504F\u597D\u548C\u7CFB\u7EDF\u53C2\u6570\u3002"
        }),
        e.jsx("div", {
          className: "grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",
          children: t.map((r) => e.jsxs(w, {
            className: "hover:shadow-md transition-shadow",
            children: [
              e.jsx(D, {
                children: e.jsx(O, {
                  className: "text-lg",
                  children: r.name
                })
              }),
              e.jsxs(S, {
                children: [
                  e.jsx(z, {
                    className: "mb-4",
                    children: r.description
                  }),
                  e.jsx(h, {
                    asChild: true,
                    children: e.jsx(v, {
                      to: r.path,
                      children: "\u67E5\u770B\u8BE6\u60C5"
                    })
                  })
                ]
              })
            ]
          }, r.path))
        })
      ]
    });
  }
  const wt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ct
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function St() {
    const t = Os.useNavigate(), { config: r, setConfig: i, models: a, isFetchingModels: s, fetchModels: l, customParamList: x, addCustomParam: c, updateCustomParam: n, removeCustomParam: o } = ds();
    return e.jsxs("div", {
      className: "container max-w-4xl mx-auto p-4 space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsx("h1", {
              className: "text-3xl font-bold",
              children: "\u5168\u5C40 LLM \u914D\u7F6E"
            }),
            e.jsx(h, {
              onClick: () => t({
                to: ".."
              }),
              children: "\u8FD4\u56DE"
            })
          ]
        }),
        e.jsx(is, {
          config: r,
          setConfig: i,
          models: a,
          isFetchingModels: s,
          fetchModels: l,
          customParamList: x,
          addCustomParam: c,
          updateCustomParam: n,
          removeCustomParam: o
        })
      ]
    });
  }
  const $t = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: St
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function It() {
    const { characterId: t } = Rs.useParams(), r = C(), { data: i = [] } = y((d) => d.from({
      c: L
    })), { data: a = [] } = y((d) => d.from({
      s: A
    })), s = i.find((d) => d.id === t), l = a.filter((d) => d.characterId === t), [x, c] = f.useState(false);
    if (!s) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u89D2\u8272\u4E0D\u5B58\u5728"
        }),
        e.jsx(h, {
          onClick: () => r({
            to: "/plaza/characters"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const n = (d) => {
      if (d === "challenge") {
        m.info("\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u6311\u6218\u5267\u672C\u4EE5\u5F00\u59CB\u6311\u6218\u6A21\u5F0F"), r({
          to: "/plaza/challenges"
        });
        return;
      }
      if (d === "dnd") {
        r({
          to: "/create/dnd"
        });
        return;
      }
      if (d === "group-chat") {
        r({
          to: "/create/group-chat"
        });
        return;
      }
      c(true);
    }, b = {
      mode: "chat",
      character: s,
      onConfirm: async (d) => {
        try {
          const _ = crypto.randomUUID(), $ = Date.now(), u = {
            id: _,
            title: `\u4E0E ${s.name} \u7684\u804A\u5929`,
            contextId: null,
            mode: "chat",
            modeConfig: {
              characterId: s.id,
              globalSystemPrompt: d.globalSystemPrompt || null,
              userName: d.userName || "User"
            },
            modeState: {},
            characterId: s.id,
            challengeId: void 0,
            createdAt: $,
            updatedAt: $,
            isActive: true
          };
          await N.sessions.add(u), r({
            to: "/session/$sessionId",
            params: {
              sessionId: _
            },
            search: {
              mode: "chat"
            }
          });
        } catch (_) {
          console.error("Failed to create session:", _), m.error("\u521B\u5EFA\u4F1A\u8BDD\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
        }
      }
    }, E = () => {
      try {
        if (!s.imageBase64) {
          m.error("\u8BE5\u89D2\u8272\u6CA1\u6709\u5934\u50CF\u56FE\u7247\uFF0C\u65E0\u6CD5\u5BFC\u51FA\u4E3A PNG \u89D2\u8272\u5361");
          return;
        }
        const d = es(s), _ = URL.createObjectURL(d), $ = document.createElement("a");
        $.href = _, $.download = `${s.name}.png`, $.click(), URL.revokeObjectURL(_), m.success(`\u89D2\u8272 ${s.name} \u5DF2\u5BFC\u51FA\u4E3A PNG \u89D2\u8272\u5361`);
      } catch (d) {
        console.error(d), m.error("\u5BFC\u51FA PNG \u89D2\u8272\u5361\u5931\u8D25");
      }
    }, ne = async () => {
      try {
        const d = a.filter((_) => _.characterId === t);
        for (const _ of d) await N.sessions.delete(_.id);
        await N.characters.delete(t), m.success("\u89D2\u8272\u5DF2\u5220\u9664"), r({
          to: "/plaza/characters"
        });
      } catch (d) {
        console.error("Failed to delete character:", d), m.error("\u5220\u9664\u89D2\u8272\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    };
    return e.jsxs("div", {
      className: "w-full max-w-5xl mx-auto p-4 md:p-8 space-y-8 animate-in fade-in duration-500",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs(h, {
              variant: "ghost",
              size: "sm",
              className: "mb-2 -ml-2 text-muted-foreground hover:bg-transparent",
              onClick: () => r({
                to: "/plaza/characters"
              }),
              type: "button",
              children: [
                e.jsx(le, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u8FD4\u56DE\u89D2\u8272\u5E7F\u573A"
              ]
            }),
            e.jsxs("div", {
              className: "flex items-center gap-2",
              children: [
                e.jsxs(re, {
                  children: [
                    e.jsx(oe, {
                      asChild: true,
                      children: e.jsxs(h, {
                        variant: "outline",
                        size: "sm",
                        className: "flex gap-2 h-8 rounded-lg",
                        type: "button",
                        children: [
                          e.jsx(U, {
                            className: "w-4 h-4"
                          }),
                          "\u5BFC\u51FA"
                        ]
                      })
                    }),
                    e.jsxs(ce, {
                      align: "end",
                      className: "w-56",
                      children: [
                        e.jsx(ls, {
                          children: "\u9009\u62E9\u5BFC\u51FA\u683C\u5F0F"
                        }),
                        e.jsx(ue, {}),
                        e.jsxs(I, {
                          onClick: E,
                          children: [
                            e.jsx(Me, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5BFC\u51FA PNG \u89D2\u8272\u5361 (\u63A8\u8350)"
                          ]
                        }),
                        e.jsx(Xe, {
                          character: s,
                          trigger: e.jsxs(I, {
                            onSelect: (d) => d.preventDefault(),
                            children: [
                              e.jsx(Fe, {
                                className: "mr-2 h-4 w-4"
                              }),
                              " \u5BFC\u51FA JSON \u539F\u59CB\u6570\u636E"
                            ]
                          })
                        })
                      ]
                    })
                  ]
                }),
                e.jsxs(re, {
                  children: [
                    e.jsx(oe, {
                      asChild: true,
                      children: e.jsx(h, {
                        variant: "ghost",
                        size: "icon",
                        className: "h-8 w-8 rounded-full",
                        type: "button",
                        children: e.jsx(Ne, {
                          className: "w-4 h-4"
                        })
                      })
                    }),
                    e.jsxs(ce, {
                      align: "end",
                      className: "w-48",
                      children: [
                        e.jsxs(I, {
                          onClick: () => r({
                            to: "/characters/$characterId/edit",
                            params: {
                              characterId: s.id
                            }
                          }),
                          children: [
                            e.jsx(pe, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u7F16\u8F91\u89D2\u8272"
                          ]
                        }),
                        e.jsxs(I, {
                          children: [
                            e.jsx(ye, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5206\u4EAB\u89D2\u8272"
                          ]
                        }),
                        e.jsx(ue, {}),
                        e.jsxs(Q, {
                          children: [
                            e.jsx(K, {
                              asChild: true,
                              children: e.jsxs(I, {
                                onSelect: (d) => d.preventDefault(),
                                className: "text-destructive focus:bg-destructive/10 focus:text-destructive",
                                children: [
                                  e.jsx(J, {
                                    className: "mr-2 h-4 w-4"
                                  }),
                                  " \u5220\u9664\u89D2\u8272"
                                ]
                              })
                            }),
                            e.jsxs(X, {
                              children: [
                                e.jsxs(Y, {
                                  children: [
                                    e.jsx(Z, {
                                      children: "\u786E\u8BA4\u5220\u9664\u89D2\u8272"
                                    }),
                                    e.jsxs(ee, {
                                      children: [
                                        '\u786E\u5B9A\u8981\u5220\u9664\u89D2\u8272 "',
                                        s.name,
                                        '" \u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\uFF0C\u4E14\u4F1A\u6E05\u9664\u6240\u6709\u5173\u8054\u7684\u4F1A\u8BDD\u8BB0\u5F55\u3002'
                                      ]
                                    })
                                  ]
                                }),
                                e.jsxs(se, {
                                  children: [
                                    e.jsx(te, {
                                      children: "\u53D6\u6D88"
                                    }),
                                    e.jsx(ae, {
                                      onClick: ne,
                                      className: "bg-destructive hover:bg-destructive/90",
                                      children: "\u786E\u8BA4\u5220\u9664"
                                    })
                                  ]
                                })
                              ]
                            })
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs("div", {
          className: "flex flex-col md:flex-row gap-8 items-start pb-8 border-b",
          children: [
            e.jsx("div", {
              className: "w-40 h-40 rounded-3xl bg-muted flex items-center justify-center shrink-0 border-4 border-background shadow-xl overflow-hidden",
              children: s.imageBase64 || s.avatar ? e.jsx("img", {
                src: s.imageBase64 || s.avatar,
                alt: s.name,
                className: "w-full h-full object-cover"
              }) : e.jsx(Ve, {
                className: "w-20 h-20 text-muted-foreground/30"
              })
            }),
            e.jsxs("div", {
              className: "space-y-5 grow",
              children: [
                e.jsxs("div", {
                  className: "space-y-1",
                  children: [
                    e.jsxs("div", {
                      className: "flex items-center gap-3",
                      children: [
                        e.jsx("h1", {
                          className: "text-4xl font-extrabold tracking-tight",
                          children: s.name
                        }),
                        e.jsxs(h, {
                          variant: "outline",
                          size: "sm",
                          onClick: () => r({
                            to: "/characters/$characterId/edit",
                            params: {
                              characterId: s.id
                            }
                          }),
                          className: "flex items-center gap-2",
                          type: "button",
                          children: [
                            e.jsx(pe, {
                              className: "w-4 h-4"
                            }),
                            "\u7F16\u8F91"
                          ]
                        })
                      ]
                    }),
                    e.jsx("p", {
                      className: "text-xl text-muted-foreground font-medium",
                      children: s.nickname || s.name
                    })
                  ]
                }),
                e.jsx("div", {
                  className: "flex flex-wrap gap-2",
                  children: s.tags.map((d) => e.jsx(R, {
                    variant: "secondary",
                    className: "px-3 py-1 font-medium",
                    children: d
                  }, d))
                }),
                e.jsxs("p", {
                  className: "text-base leading-relaxed text-muted-foreground/90 max-w-2xl",
                  children: [
                    s.description.slice(0, 200),
                    s.description.length > 200 ? "..." : ""
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs(ie, {
          defaultValue: "sessions",
          className: "w-full",
          children: [
            e.jsxs(de, {
              className: "w-full justify-start h-12 bg-muted/50 p-1 mb-6",
              children: [
                e.jsx(P, {
                  value: "sessions",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u4F1A\u8BDD & \u8BB0\u5F55"
                }),
                e.jsx(P, {
                  value: "details",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u6863\u6848\u8BE6\u60C5"
                })
              ]
            }),
            e.jsx(B, {
              value: "sessions",
              className: "mt-0",
              children: e.jsx("div", {
                className: "grid grid-cols-1 md:grid-cols-1 gap-8",
                children: e.jsx(Ye, {
                  characterId: s.id,
                  sessions: l,
                  onStartNew: n
                })
              })
            }),
            e.jsx(B, {
              value: "details",
              className: "mt-0",
              children: e.jsx(Ze, {
                character: s
              })
            })
          ]
        }),
        e.jsx($e, {
          open: x,
          onOpenChange: c,
          wizardProps: b
        })
      ]
    });
  }
  const Pt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: It
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Dt() {
    var _a;
    const { challengeId: t } = Ts.useParams(), r = C(), { data: i = [] } = y((u) => u.from({
      c: we
    })), a = i.find((u) => u.id === t), { data: s = [] } = y((u) => u.from({
      s: A
    })), { data: l = [] } = y((u) => u.from({
      char: L
    })), x = s.filter((u) => u.challengeId === t), [c, n] = f.useState(false), [o, b] = f.useState(null);
    if (!a) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u6311\u6218\u4E0D\u5B58\u5728"
        }),
        e.jsx(h, {
          onClick: () => r({
            to: "/plaza/challenges"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const E = (u) => {
      b(u), n(true);
    }, ne = async () => {
      if (o) try {
        const u = Ie(), me = Date.now(), he = {};
        for (const [k, De] of Object.entries(a.variables)) he[k] = {
          key: k,
          value: De.initial
        };
        const Pe = {
          id: u,
          title: `${a.name}`,
          contextId: null,
          mode: "challenge",
          modeConfig: {
            characterId: o,
            roleTaskPrompt: a.roleTaskPrompt,
            userGuidance: a.userGuidance,
            variables: a.variables,
            goals: a.goals,
            failureChecks: a.failureChecks
          },
          modeState: {
            currentPhase: "dm_intro",
            currentUIState: "idle",
            variableStates: he,
            goalStates: a.goals.map((k) => ({
              key: k.key,
              checkCount: 0,
              isMet: false
            })),
            failureStates: a.failureChecks.map((k) => ({
              key: k.key,
              checkCount: 0,
              isMet: false
            }))
          },
          characterId: o,
          challengeId: a.id,
          createdAt: me,
          updatedAt: me,
          isActive: true
        };
        await N.sessions.add(Pe), r({
          to: "/session/$sessionId",
          params: {
            sessionId: u
          },
          search: {
            mode: "challenge"
          }
        });
      } catch (u) {
        console.error("Failed to create challenge session:", u), m.error("\u521B\u5EFA\u4F1A\u8BDD\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, d = l.find((u) => u.id === o), _ = d ? {
      mode: "challenge",
      character: d,
      challenge: a,
      onConfirm: ne
    } : null, $ = () => {
      m.success(`\u6B63\u5728\u5BFC\u51FA\u6311\u6218 ${a.name}...`);
    };
    return e.jsxs("div", {
      className: "max-w-5xl mx-auto p-4 md:p-8 space-y-8 animate-in fade-in slide-in-from-bottom-2 duration-500 relative",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs(h, {
              variant: "ghost",
              size: "sm",
              className: "mb-2 -ml-2 text-muted-foreground hover:bg-transparent",
              onClick: () => r({
                to: "/plaza/challenges"
              }),
              type: "button",
              children: [
                e.jsx(le, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u8FD4\u56DE\u6311\u6218\u5E7F\u573A"
              ]
            }),
            e.jsxs("div", {
              className: "flex items-center gap-2",
              children: [
                e.jsxs(h, {
                  variant: "outline",
                  size: "sm",
                  className: "hidden sm:flex gap-2 h-8 rounded-lg",
                  onClick: $,
                  type: "button",
                  children: [
                    e.jsx(U, {
                      className: "w-4 h-4"
                    }),
                    "\u5BFC\u51FA\u6311\u6218"
                  ]
                }),
                e.jsxs(re, {
                  children: [
                    e.jsx(oe, {
                      asChild: true,
                      children: e.jsx(h, {
                        variant: "ghost",
                        size: "icon",
                        className: "h-8 w-8 rounded-full",
                        type: "button",
                        children: e.jsx(Ne, {
                          className: "w-4 h-4"
                        })
                      })
                    }),
                    e.jsxs(ce, {
                      align: "end",
                      className: "w-48",
                      children: [
                        e.jsxs(I, {
                          onClick: $,
                          className: "sm:hidden",
                          children: [
                            e.jsx(U, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5BFC\u51FA JSON"
                          ]
                        }),
                        e.jsxs(I, {
                          children: [
                            e.jsx(ye, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5206\u4EAB\u6311\u6218"
                          ]
                        }),
                        e.jsxs(Q, {
                          children: [
                            e.jsx(K, {
                              asChild: true,
                              children: e.jsxs(I, {
                                onSelect: (u) => u.preventDefault(),
                                className: "text-destructive focus:bg-destructive/10 focus:text-destructive",
                                children: [
                                  e.jsx(J, {
                                    className: "mr-2 h-4 w-4"
                                  }),
                                  " \u5220\u9664\u6311\u6218"
                                ]
                              })
                            }),
                            e.jsxs(X, {
                              children: [
                                e.jsxs(Y, {
                                  children: [
                                    e.jsx(Z, {
                                      children: "\u786E\u8BA4\u5220\u9664\u6311\u6218"
                                    }),
                                    e.jsxs(ee, {
                                      children: [
                                        "\u786E\u5B9A\u8981\u5220\u9664\u6311\u6218\u300C",
                                        a.name,
                                        "\u300D\u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002"
                                      ]
                                    })
                                  ]
                                }),
                                e.jsxs(se, {
                                  children: [
                                    e.jsx(te, {
                                      children: "\u53D6\u6D88"
                                    }),
                                    e.jsx(ae, {
                                      className: "bg-destructive hover:bg-destructive/90",
                                      onClick: async () => {
                                        await N.challenges.delete(a.id), m.success("\u6311\u6218\u5DF2\u5220\u9664"), r({
                                          to: "/plaza/challenges"
                                        });
                                      },
                                      children: "\u786E\u8BA4\u5220\u9664"
                                    })
                                  ]
                                })
                              ]
                            })
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs("div", {
          className: "flex flex-col md:flex-row gap-8 items-start pb-8 border-b",
          children: [
            e.jsx("div", {
              className: "w-40 h-40 rounded-3xl bg-primary/10 flex items-center justify-center shrink-0 border-4 border-background shadow-xl overflow-hidden",
              children: e.jsx(fe, {
                className: "w-20 h-20 text-primary"
              })
            }),
            e.jsxs("div", {
              className: "space-y-4 grow",
              children: [
                e.jsxs("div", {
                  className: "space-y-2",
                  children: [
                    e.jsx(R, {
                      variant: "outline",
                      className: "text-primary bg-primary/5 border-primary/20 uppercase tracking-widest text-[10px] px-2",
                      children: "Challenge Scenario"
                    }),
                    e.jsx("h1", {
                      className: "text-4xl font-extrabold tracking-tight",
                      children: a.name
                    })
                  ]
                }),
                e.jsx("div", {
                  className: "flex flex-wrap gap-2",
                  children: (_a = a.tags) == null ? void 0 : _a.map((u) => e.jsx(R, {
                    variant: "secondary",
                    className: "px-3 py-1 font-medium",
                    children: u
                  }, u))
                }),
                e.jsxs("p", {
                  className: "text-lg leading-relaxed text-muted-foreground italic font-serif",
                  children: [
                    '" ',
                    a.description.slice(0, 150),
                    '... "'
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs(ie, {
          defaultValue: "details",
          className: "w-full",
          children: [
            e.jsxs(de, {
              className: "w-full justify-start h-12 bg-muted/50 p-1 mb-6",
              children: [
                e.jsx(P, {
                  value: "details",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u6311\u6218\u8BE6\u60C5"
                }),
                e.jsx(P, {
                  value: "sessions",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u5173\u8054\u4F1A\u8BDD"
                })
              ]
            }),
            e.jsx(B, {
              value: "details",
              className: "mt-0",
              children: e.jsx(ss, {
                challenge: a
              })
            }),
            e.jsx(B, {
              value: "sessions",
              className: "mt-0",
              children: e.jsx(ts, {
                challengeId: a.id,
                sessions: x,
                characters: l,
                onStartNew: E
              })
            })
          ]
        }),
        _ && e.jsx($e, {
          open: c,
          onOpenChange: n,
          wizardProps: _
        })
      ]
    });
  }
  const Ot = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Dt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function zt() {
    const { characterId: t } = Es.useParams(), r = C(), { data: i = [] } = y((c) => c.from({
      c: L
    })), a = i.find((c) => c.id === t);
    if (!a) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u89D2\u8272\u4E0D\u5B58\u5728"
        }),
        e.jsx(h, {
          onClick: () => r({
            to: "/plaza/characters"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const s = async (c) => {
      try {
        const n = Date.now(), o = {
          ...a,
          ...c,
          updatedAt: n,
          modification_date: n
        };
        await N.characters.put(o), m.success(`\u89D2\u8272 ${a.name} \u5DF2\u66F4\u65B0`), r({
          to: "/characters/$characterId",
          params: {
            characterId: a.id
          }
        });
      } catch (n) {
        console.error("Failed to update character:", n), m.error("\u66F4\u65B0\u89D2\u8272\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, l = () => {
      r({
        to: "/characters/$characterId",
        params: {
          characterId: a.id
        }
      });
    }, x = a;
    return e.jsxs("div", {
      className: "w-full max-w-5xl mx-auto p-4 md:p-8 space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center gap-2",
          children: [
            e.jsxs(h, {
              variant: "ghost",
              size: "sm",
              className: "text-muted-foreground hover:bg-transparent",
              onClick: l,
              type: "button",
              children: [
                e.jsx(le, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u53D6\u6D88\u7F16\u8F91"
              ]
            }),
            e.jsxs("h1", {
              className: "text-xl font-bold",
              children: [
                "\u7F16\u8F91\u89D2\u8272: ",
                a.name
              ]
            })
          ]
        }),
        e.jsx(Se, {
          onSave: s,
          onCancel: l,
          initialData: x,
          mode: "edit"
        })
      ]
    });
  }
  const Rt = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: zt
  }, Symbol.toStringTag, {
    value: "Module"
  }));
})();
export {
  Ut as R,
  __tla,
  Bt as a,
  Wt as b,
  qt as c,
  Ht as d,
  Jt as e,
  Qt as f,
  Kt as g,
  Xt as h,
  ge as i,
  Yt as j,
  Zt as k,
  ea as l,
  sa as m,
  ta as n,
  aa as o,
  na as p,
  ra as q,
  oa as r,
  ca as s,
  Os as t,
  Rs as u,
  Ts as v,
  Es as w
};

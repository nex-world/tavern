const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-libs-for-silly-tavern-DZz8R7DJ.js","assets/react-DwoZtHR8.js","assets/index-BHy3yCie.js","assets/vendor-KHQmFMTG.js","assets/@tanstack-TnKfVvnC.js","assets/dexie-RC68qVM3.js","assets/app-components-f9q2KBqK.js","assets/icons-KB3ML1Zw.js","assets/app-hooks-CLX024ue.js","assets/id-OxPLOBIU.js","assets/future-lib-llm-ui-react-31Wddr-o.js","assets/es-toolkit-CstbrnlE.js","assets/app-lib-Ce77exfW.js","assets/components-and-styling-lnR2ABT4.js","assets/@tailwind-COJ8Fh6m.js","assets/zod-grrOrvCS.js","assets/app-libs-for-custom-theme-CPPzqlBn.js","assets/gsap-DDlvirwQ.js","assets/app-components-DvwNuPEv.css","assets/@radix-ui-BQCqNqg0.js","assets/immer-BCQU3qJI.js","assets/app-styles--c83vU95.css"])))=>i.map(i=>d[i]);
import { _ as h, D as ce } from "./index-BHy3yCie.js";
import { g as p, l as u, r as le, L as N, O as R, e as b, h as ie, i as v, f as de, N as me } from "./@tanstack-TnKfVvnC.js";
import { j as e, r as f, t as l } from "./react-DwoZtHR8.js";
import { f as z, U as Q, H as K, g as he, a as H, h as X, M as pe, i as Y, P as Z, D as I, j as F, k as ue, F as xe, E as ee, l as J, m as se, n as te, o as ge } from "./icons-KB3ML1Zw.js";
import { S as je, a as U, C as w, m as _, b as ae, c as fe, E as ve, I as ne, d as _e, e as oe, f as Ne, g as ye, h as re, i as be, j as Ce, k as we, l as $e, n as Ie } from "./app-libs-for-silly-tavern-DZz8R7DJ.js";
import { y as B, z as G, A as C, C as S, E as P, F as O, G as k, H as D, S as Se, J as Pe, B as m, K as Oe, L as $, f as W, N as ke, O as De, P as L, Q as A, R as E, U as Re, V as q, W as y, X as ze, Y as Te, Z as Le, _ as Ae, $ as Ee, a0 as Me, a1 as Ve, a2 as Fe, a3 as Ue, d as M, a4 as V } from "./app-components-f9q2KBqK.js";
import { C as Be } from "./future-lib-llm-ui-react-31Wddr-o.js";
import { a as Ge } from "./app-lib-Ce77exfW.js";
let lt, it, dt, mt, ht, pt, ut, xt, gt, es, jt, ft, vt, _t, Nt, yt, ls, ds, hs, us;
let __tla = (async () => {
  let He, Je, We, qe, Qe, Ke, Xe, Ye, Ze, ss, ts, as, ns, os, rs, cs, is, ms, ps, xs, gs;
  He = () => h(() => Promise.resolve().then(() => gs), void 0);
  lt = p("/_layout-game")({
    component: u(He, "component")
  });
  Je = () => h(() => Promise.resolve().then(() => fs), void 0);
  it = p("/_layout-game/_silly-tavern")({
    head: () => ({
      meta: [
        {
          title: "SillyTavern Lite | AI \u89D2\u8272\u626E\u6F14\u5E73\u53F0"
        },
        {
          name: "description",
          content: "\u8F7B\u91CF\u7EA7 AI \u89D2\u8272\u626E\u6F14\u5E73\u53F0\uFF0C\u652F\u6301\u89D2\u8272\u5361\u521B\u5EFA\u3001\u6311\u6218\u8BBE\u5B9A\u548C\u5BF9\u8BDD\u4F1A\u8BDD\u7BA1\u7406"
        }
      ]
    }),
    component: u(Je, "component")
  });
  We = () => h(() => Promise.resolve().then(() => _s), void 0);
  dt = p("/_layout-game/_silly-tavern/")({
    head: () => ({
      meta: [
        {
          title: "\u6B22\u8FCE\u6765\u5230 SillyTavern Lite | Welcome to SillyTavern Lite"
        },
        {
          name: "description",
          content: "\u6B22\u8FCE\u4F7F\u7528 SillyTavern Lite\uFF0CAI \u89D2\u8272\u626E\u6F14\u521B\u4F5C\u5E73\u53F0"
        }
      ]
    }),
    component: u(We, "component")
  });
  qe = () => h(() => Promise.resolve().then(() => ys), void 0);
  mt = p("/_layout-game/_silly-tavern/session")({
    head: () => ({
      meta: [
        {
          title: "\u5BF9\u8BDD\u4F1A\u8BDD | Chat Sessions"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u4F60\u7684 AI \u89D2\u8272\u626E\u6F14\u5BF9\u8BDD\u4F1A\u8BDD\uFF0C\u67E5\u770B\u5386\u53F2\u8BB0\u5F55\u548C\u7EE7\u7EED\u5BF9\u8BDD"
        }
      ]
    }),
    component: u(qe, "component")
  });
  Qe = () => h(() => Promise.resolve().then(() => Cs), void 0);
  ht = p("/_layout-game/_silly-tavern/plaza")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5E7F\u573A | Character Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u89D2\u8272\u5361\u4E0E\u6311\u6218\u5361\uFF0C\u5F00\u59CB\u4F60\u7684 AI \u89D2\u8272\u626E\u6F14\u5192\u9669"
        }
      ]
    }),
    component: u(Qe, "component")
  });
  Ke = () => h(() => Promise.resolve().then(() => $s), void 0);
  pt = p("/_layout-game/_silly-tavern/create")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u4F5C\u8005\u5DE5\u574A | Creator Workshop"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u548C\u7BA1\u7406\u4F60\u7684\u89D2\u8272\u5361\u4E0E\u6311\u6218\u8BBE\u5B9A\uFF0C\u6253\u9020\u72EC\u7279\u7684 AI \u89D2\u8272\u626E\u6F14\u4F53\u9A8C"
        }
      ]
    }),
    component: u(Ke, "component")
  });
  Xe = () => h(() => Promise.resolve().then(() => Ss), void 0);
  ut = p("/_layout-game/_silly-tavern/config")({
    head: () => ({
      meta: [
        {
          title: "\u914D\u7F6E\u7BA1\u7406 | Configuration"
        },
        {
          name: "description",
          content: "\u5E94\u7528\u914D\u7F6E\u7BA1\u7406\u4E2D\u5FC3\uFF0C\u5305\u62EC LLM \u914D\u7F6E\u3001\u7CFB\u7EDF\u8BBE\u7F6E\u7B49"
        }
      ]
    }),
    component: u(Xe, "component")
  });
  xt = p("/_layout-game/_silly-tavern/plaza/")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5E7F\u573A | Character Plaza"
        },
        {
          name: "description",
          content: "SillyTavern \u89D2\u8272\u5E7F\u573A\uFF0C\u6D4F\u89C8\u89D2\u8272\u5361\u548C\u6311\u6218\u5361"
        }
      ]
    }),
    beforeLoad: () => {
      throw le({
        to: "/plaza/characters"
      });
    }
  });
  Ye = () => h(() => Promise.resolve().then(() => Os), void 0);
  gt = p("/_layout-game/_silly-tavern/config/")({
    component: u(Ye, "component")
  });
  Ze = () => h(() => Promise.resolve().then(() => Rs), void 0);
  es = p("/_layout-game/_silly-tavern/session/$sessionId")({
    head: () => ({
      meta: [
        {
          title: "\u5BF9\u8BDD\u4F1A\u8BDD | Chat Session"
        },
        {
          name: "description",
          content: "\u4E0E AI \u89D2\u8272\u8FDB\u884C\u5BF9\u8BDD\u4F1A\u8BDD\uFF0C\u4F53\u9A8C\u89D2\u8272\u626E\u6F14\u4E92\u52A8"
        }
      ]
    }),
    component: u(Ze, "component")
  });
  ss = () => h(() => Promise.resolve().then(() => Ts), void 0);
  jt = p("/_layout-game/_silly-tavern/plaza/characters")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u5361\u5E7F\u573A | Character Cards Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u89D2\u8272\u5361\uFF0C\u4E0E AI \u89D2\u8272\u5F00\u59CB\u5BF9\u8BDD\u548C\u89D2\u8272\u626E\u6F14"
        }
      ]
    }),
    component: u(ss, "component")
  });
  ts = () => h(() => Promise.resolve().then(() => As), void 0);
  ft = p("/_layout-game/_silly-tavern/plaza/challenges")({
    head: () => ({
      meta: [
        {
          title: "\u6311\u6218\u5361\u5E7F\u573A | Challenge Cards Plaza"
        },
        {
          name: "description",
          content: "\u6D4F\u89C8\u548C\u9009\u62E9\u6311\u6218\u5361\uFF0C\u4F53\u9A8C\u4E0D\u540C\u7684 AI \u89D2\u8272\u626E\u6F14\u6311\u6218\u6A21\u5F0F"
        }
      ]
    }),
    component: u(ts, "component")
  });
  as = () => h(() => Promise.resolve().then(() => Ms), void 0);
  vt = p("/_layout-game/_silly-tavern/create_/character")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA\u89D2\u8272\u5361 | Create Character Card"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u65B0\u7684 AI \u89D2\u8272\u5361\uFF0C\u5B9A\u4E49\u4EBA\u683C\u3001\u80CC\u666F\u548C\u5BF9\u8BDD\u98CE\u683C"
        }
      ]
    }),
    component: u(as, "component")
  });
  ns = () => h(() => Promise.resolve().then(() => Fs), void 0);
  _t = p("/_layout-game/_silly-tavern/create_/challenge")({
    head: () => ({
      meta: [
        {
          title: "\u521B\u5EFA\u6311\u6218\u5361 | Create Challenge Card"
        },
        {
          name: "description",
          content: "\u521B\u5EFA\u65B0\u7684\u6311\u6218\u5361\uFF0C\u8BBE\u5B9A\u4E16\u754C\u53D8\u91CF\u3001\u6210\u5C31\u76EE\u6807\u548C DM \u5F15\u5BFC\u89C4\u5219"
        }
      ]
    }),
    component: u(ns, "component")
  });
  os = () => h(() => Promise.resolve().then(() => Bs), void 0);
  Nt = p("/_layout-game/_silly-tavern/config/settings")({
    head: () => ({
      meta: [
        {
          title: "\u5E94\u7528\u8BBE\u7F6E | Application Settings"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u5E94\u7528\u7684\u57FA\u672C\u914D\u7F6E\u3001\u504F\u597D\u8BBE\u7F6E\u548C\u7528\u6237\u9009\u9879"
        }
      ]
    }),
    component: u(os, "component")
  });
  rs = () => h(() => Promise.resolve().then(() => Hs), void 0);
  yt = p("/_layout-game/_silly-tavern/config/overview")({
    head: () => ({
      meta: [
        {
          title: "\u914D\u7F6E\u7BA1\u7406\u6982\u89C8 | Configuration Overview"
        },
        {
          name: "description",
          content: "\u914D\u7F6E\u7BA1\u7406\u4E2D\u5FC3\u6982\u89C8\uFF0C\u5C55\u793A\u6240\u6709\u53EF\u914D\u7F6E\u7684\u9879\u76EE\u548C\u8BBE\u7F6E"
        }
      ]
    }),
    component: u(rs, "component")
  });
  cs = () => h(() => Promise.resolve().then(() => Ws), void 0);
  ls = p("/_layout-game/_silly-tavern/config/llm")({
    head: () => ({
      meta: [
        {
          title: "LLM \u914D\u7F6E | LLM Configuration"
        },
        {
          name: "description",
          content: "\u7BA1\u7406\u5927\u8BED\u8A00\u6A21\u578B\u914D\u7F6E\uFF0C\u5305\u62EC API \u5BC6\u94A5\u3001\u6A21\u578B\u9009\u62E9\u548C\u8C03\u7528\u53C2\u6570"
        }
      ]
    }),
    component: u(cs, "component")
  });
  is = () => h(() => Promise.resolve().then(() => Qs), void 0);
  ds = p("/_layout-game/_silly-tavern/characters_/$characterId")({
    head: () => ({
      meta: [
        {
          title: "\u89D2\u8272\u8BE6\u60C5 | Character Details"
        },
        {
          name: "description",
          content: "\u67E5\u770B\u89D2\u8272\u5361\u8BE6\u60C5\u3001\u4F1A\u8BDD\u5386\u53F2\u548C\u7BA1\u7406\u89D2\u8272\u8BBE\u7F6E"
        }
      ]
    }),
    component: u(is, "component")
  });
  ms = () => h(() => Promise.resolve().then(() => Xs), void 0);
  hs = p("/_layout-game/_silly-tavern/challenges_/$challengeId")({
    head: () => ({
      meta: [
        {
          title: "\u6311\u6218\u8BE6\u60C5 | Challenge Details"
        },
        {
          name: "description",
          content: "\u67E5\u770B\u6311\u6218\u5361\u8BE6\u60C5\u3001\u89C4\u5219\u8BBE\u7F6E\u548C\u76F8\u5173\u4F1A\u8BDD\u8BB0\u5F55"
        }
      ]
    }),
    component: u(ms, "component")
  });
  ps = () => h(() => Promise.resolve().then(() => Zs), void 0);
  us = p("/_layout-game/_silly-tavern/characters_/$characterId_/edit")({
    head: () => ({
      meta: [
        {
          title: "\u7F16\u8F91\u89D2\u8272\u5361 | Edit Character Card"
        },
        {
          name: "description",
          content: "\u7F16\u8F91\u73B0\u6709\u89D2\u8272\u5361\u7684\u5C5E\u6027\u3001\u80CC\u666F\u548C\u5BF9\u8BDD\u8BBE\u7F6E"
        }
      ]
    }),
    component: u(ps, "component")
  });
  xs = ce;
  gs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: xs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function js() {
    return e.jsxs("div", {
      className: "flex flex-col h-full overflow-hidden",
      children: [
        e.jsx("header", {
          className: "h-14 border-b bg-background flex items-center px-4 justify-between shrink-0",
          children: e.jsxs("div", {
            className: "flex items-center gap-2",
            children: [
              e.jsxs(N, {
                to: "/",
                className: "flex items-center gap-2 font-bold text-lg mr-6",
                children: [
                  e.jsx(z, {
                    className: "w-5 h-5 text-primary"
                  }),
                  e.jsx("span", {
                    children: "SillyTavern Lite"
                  })
                ]
              }),
              e.jsxs("nav", {
                className: "flex items-center gap-1",
                children: [
                  e.jsxs(N, {
                    to: "/plaza/characters",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(Q, {
                        className: "w-4 h-4"
                      }),
                      "\u5E7F\u573A"
                    ]
                  }),
                  e.jsxs(N, {
                    to: "/create",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(K, {
                        className: "w-4 h-4"
                      }),
                      "\u5DE5\u574A"
                    ]
                  }),
                  e.jsxs(N, {
                    to: "/session",
                    className: "px-3 py-1.5 text-sm font-medium rounded-md hover:bg-muted [&.active]:bg-primary/10 [&.active]:text-primary flex items-center gap-1.5",
                    children: [
                      e.jsx(he, {
                        className: "w-4 h-4"
                      }),
                      "\u4F1A\u8BDD"
                    ]
                  })
                ]
              })
            ]
          })
        }),
        e.jsx("main", {
          className: "grow overflow-auto flex flex-col",
          children: e.jsx(R, {})
        })
      ]
    });
  }
  const fs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: js
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function vs() {
    const o = b();
    return f.useEffect(() => {
      const r = setTimeout(() => {
        o({
          to: "/plaza/characters"
        });
      }, 3e3);
      return () => clearTimeout(r);
    }, [
      o
    ]), e.jsxs("div", {
      className: "flex flex-col items-center justify-center h-full bg-background space-y-6",
      children: [
        e.jsxs("div", {
          className: "relative",
          children: [
            e.jsx("div", {
              className: "absolute -inset-1 rounded-full bg-primary/20 blur-xl animate-pulse"
            }),
            e.jsx(z, {
              className: "w-20 h-20 text-primary relative"
            })
          ]
        }),
        e.jsxs("div", {
          className: "text-center space-y-2",
          children: [
            e.jsx("h1", {
              className: "text-4xl font-bold tracking-tight",
              children: "SillyTavern Lite"
            }),
            e.jsx("p", {
              className: "text-muted-foreground",
              children: "\u6B22\u8FCE\u56DE\u6765\uFF0C\u521B\u4F5C\u8005"
            })
          ]
        }),
        e.jsx("div", {
          className: "flex items-center gap-2 text-sm text-muted-foreground animate-bounce",
          children: e.jsx("span", {
            children: "\u5373\u5C06\u8FDB\u5165\u5E7F\u573A..."
          })
        })
      ]
    });
  }
  const _s = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: vs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ns() {
    const o = b(), { sessionId: r } = ie({
      strict: false
    }), { data: d = [] } = v((c) => c.from({
      s: U
    })), { data: t = [] } = v((c) => c.from({
      c: w
    })), a = (c) => {
      o({
        to: "/session/$sessionId",
        params: {
          sessionId: c.id
        }
      });
    }, g = () => {
      o({
        to: "/plaza/characters"
      });
    }, x = async (c) => {
      try {
        await _.sessions.delete(c.id);
      } catch (n) {
        console.error("Failed to delete session:", n);
      }
    };
    return e.jsxs("div", {
      className: "flex h-full overflow-hidden",
      children: [
        e.jsx(je, {
          sessions: d,
          characters: t,
          activeSessionId: r,
          onSessionSelect: a,
          onNewSession: g,
          onSessionDelete: x
        }),
        e.jsx("div", {
          className: "grow overflow-hidden relative",
          children: e.jsx(R, {})
        })
      ]
    });
  }
  const ys = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ns
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function bs() {
    const r = de().pathname.includes("challenges") ? "challenges" : "characters";
    return e.jsxs("div", {
      className: "flex flex-col h-full overflow-y-auto",
      children: [
        e.jsx("div", {
          className: "border-b px-6 py-2 bg-muted/20",
          children: e.jsx(B, {
            value: r,
            className: "w-fit",
            children: e.jsxs(G, {
              children: [
                e.jsx(N, {
                  to: "/plaza/characters",
                  children: e.jsx(C, {
                    value: "characters",
                    children: "\u89D2\u8272\u5361"
                  })
                }),
                e.jsx(C, {
                  value: "challenges",
                  onClick: () => l.info("\u6311\u6218\u5361\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85"),
                  className: "cursor-pointer",
                  children: "\u6311\u6218\u5361"
                })
              ]
            })
          })
        }),
        e.jsx("div", {
          className: "p-6",
          children: e.jsx(R, {})
        })
      ]
    });
  }
  const Cs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: bs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function ws() {
    return e.jsxs("div", {
      className: "p-6 max-w-4xl mx-auto space-y-8",
      children: [
        e.jsxs("div", {
          className: "space-y-2",
          children: [
            e.jsxs("h1", {
              className: "text-3xl font-bold flex items-center gap-2",
              children: [
                e.jsx(K, {
                  className: "w-8 h-8 text-primary"
                }),
                "\u521B\u4F5C\u8005\u5DE5\u574A"
              ]
            }),
            e.jsx("p", {
              className: "text-muted-foreground",
              children: "\u5728\u8FD9\u91CC\u521B\u5EFA\u548C\u7BA1\u7406\u4F60\u7684\u89D2\u8272\u5361\u4E0E\u6311\u6218\u6311\u6218\u8BBE\u5B9A\u3002"
            })
          ]
        }),
        e.jsxs("div", {
          className: "grid grid-cols-1 md:grid-cols-2 gap-6",
          children: [
            e.jsx(N, {
              to: "/create/character",
              children: e.jsxs(S, {
                className: "hover:border-primary transition-colors cursor-pointer group h-full",
                children: [
                  e.jsxs(P, {
                    children: [
                      e.jsx(Q, {
                        className: "w-10 h-10 mb-2 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(O, {
                        children: "\u65B0\u89D2\u8272\u5361"
                      }),
                      e.jsx(k, {
                        children: "\u5B9A\u4E49\u89D2\u8272\u7684\u4EBA\u683C\u3001\u80CC\u666F\u3001\u5F00\u573A\u767D\u548C\u5BF9\u8BDD\u98CE\u683C\u3002"
                      })
                    ]
                  }),
                  e.jsx(D, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-primary",
                      children: [
                        "\u7ACB\u5373\u5F00\u59CB ",
                        e.jsx(H, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            }),
            e.jsx("div", {
              className: "hover:border-primary transition-colors cursor-not-allowed group h-full opacity-50",
              onClick: () => l.info("\u6311\u6218\u5361\u529F\u80FD\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85"),
              children: e.jsxs(S, {
                className: "h-full",
                children: [
                  e.jsxs(P, {
                    children: [
                      e.jsx(X, {
                        className: "w-10 h-10 mb-2 group-hover:scale-110 transition-transform"
                      }),
                      e.jsx(O, {
                        children: "\u65B0\u6311\u6218\u5361"
                      }),
                      e.jsx(k, {
                        children: "\u8BBE\u5B9A\u4E16\u754C\u53D8\u91CF\u3001\u6210\u5C31\u76EE\u6807\u548C DM \u7684\u5F15\u5BFC\u89C4\u5219\u3002"
                      })
                    ]
                  }),
                  e.jsx(D, {
                    children: e.jsxs("div", {
                      className: "flex items-center text-sm font-medium text-primary",
                      children: [
                        "\u5373\u5C06\u5F00\u653E ",
                        e.jsx(H, {
                          className: "w-4 h-4 ml-1"
                        })
                      ]
                    })
                  })
                ]
              })
            })
          ]
        })
      ]
    });
  }
  const $s = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: ws
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Is() {
    const [o, r] = f.useState(false), d = e.jsxs(e.Fragment, {
      children: [
        e.jsx("h2", {
          className: "text-lg font-semibold mb-4",
          children: "\u914D\u7F6E\u7BA1\u7406"
        }),
        e.jsxs("ul", {
          className: "space-y-2",
          children: [
            e.jsx("li", {
              children: e.jsx(N, {
                to: "/config/overview",
                className: "block p-2 rounded hover:bg-foreground/5 md:hover:bg-background",
                onClick: () => r(false),
                children: "\u6982\u89C8"
              })
            }),
            e.jsx("li", {
              children: e.jsx(N, {
                to: "/config/llm",
                className: "block p-2 rounded hover:bg-foreground/5 md:hover:bg-background",
                onClick: () => r(false),
                children: "LLM \u914D\u7F6E"
              })
            })
          ]
        })
      ]
    });
    return e.jsxs("div", {
      className: "flex h-full",
      children: [
        e.jsx("nav", {
          className: "hidden md:block w-64 p-4 bg-foreground/5 overflow-y-auto",
          children: d
        }),
        e.jsxs(Se, {
          open: o,
          onOpenChange: r,
          children: [
            e.jsx(Pe, {
              asChild: true,
              children: e.jsx(m, {
                variant: "outline",
                size: "icon",
                className: "md:hidden fixed bottom-8 left-8 rounded-full shadow-lg z-50",
                children: e.jsx(pe, {
                  className: "h-4 w-4"
                })
              })
            }),
            e.jsx(Oe, {
              side: "left",
              className: "w-64 p-4 overflow-y-auto",
              children: d
            })
          ]
        }),
        e.jsx("main", {
          className: "flex-1 p-4 lg:px-8 xl:px-12 overflow-auto",
          children: e.jsx(R, {})
        })
      ]
    });
  }
  const Ss = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Is
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ps() {
    return e.jsx(me, {
      to: "/config/overview"
    });
  }
  const Os = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ps
  }, Symbol.toStringTag, {
    value: "Module"
  })), ks = f.lazy(() => h(() => import("./app-libs-for-silly-tavern-DZz8R7DJ.js").then((o) => o.o), __vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then((o) => ({
    default: o.SessionMainForChat
  })));
  function Ds() {
    const { sessionId: o } = es.useParams();
    return e.jsx(f.Suspense, {
      fallback: e.jsx("div", {
        className: "flex flex-col items-center justify-center h-full text-muted-foreground space-y-4",
        children: e.jsx("p", {
          children: "\u52A0\u8F7D\u4E2D..."
        })
      }),
      children: e.jsx(ks, {
        sessionId: o
      })
    });
  }
  const Rs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ds
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function zs() {
    const o = b(), [r, d] = f.useState(false), { data: t = [] } = v((s) => s.from({
      c: w
    })), a = (s) => {
      o({
        to: "/characters/$characterId",
        params: {
          characterId: s.id
        }
      });
    }, g = (s) => {
      o({
        to: "/characters/$characterId",
        params: {
          characterId: s.id
        }
      });
    }, x = async (s) => {
      try {
        await _.characters.add(s), l.success(`\u6210\u529F\u5BFC\u5165\u89D2\u8272: ${s.name}`);
      } catch (i) {
        l.error("\u5BFC\u5165\u5931\u8D25"), console.error(i);
      }
    }, c = async () => {
      try {
        let s = 0;
        for (const i of _e) try {
          await _.characters.add(i), s++;
        } catch (j) {
          console.error(`Failed to import preset ${i.name}:`, j);
        }
        s > 0 ? l.success(`\u6210\u529F\u5BFC\u5165 ${s} \u4E2A\u89D2\u8272\u9884\u8BBE`) : l.error("\u6CA1\u6709\u627E\u5230\u53EF\u5BFC\u5165\u7684\u89D2\u8272\u9884\u8BBE");
      } catch (s) {
        l.error("\u5BFC\u5165\u9884\u8BBE\u5931\u8D25"), console.error(s);
      }
    }, n = e.jsxs("div", {
      className: "flex items-center gap-2",
      children: [
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: () => d(true),
          children: [
            e.jsx(Y, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u89D2\u8272"
          ]
        }),
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: c,
          children: [
            e.jsx(z, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u9884\u8BBE"
          ]
        }),
        e.jsx(ve, {
          characters: t
        }),
        e.jsxs(m, {
          variant: "default",
          size: "sm",
          className: "flex items-center gap-2",
          onClick: () => o({
            to: "/create/character"
          }),
          type: "button",
          children: [
            e.jsx(Z, {
              className: "w-4 h-4"
            }),
            "\u65B0\u5EFA\u89D2\u8272"
          ]
        }),
        e.jsx(ne, {
          open: r,
          onOpenChange: d,
          onImport: x
        })
      ]
    });
    return e.jsx(ae, {
      items: t,
      title: "\u89D2\u8272\u5217\u8868",
      placeholder: "\u641C\u7D22\u540D\u79F0\u3001\u63CF\u8FF0\u6216\u6807\u7B7E...",
      actions: n,
      getSearchableContent: (s) => `${s.name} ${s.description} ${s.tags.join(" ")}`,
      getTags: (s) => s.tags,
      getId: (s) => s.id,
      renderCard: (s) => e.jsx(fe, {
        character: s,
        onClick: g,
        onStartSession: a
      })
    });
  }
  const Ts = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: zs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ls() {
    const o = b(), [r, d] = f.useState(false), { data: t = [] } = v((n) => n.from({
      c: oe
    })), a = (n) => {
      o({
        to: "/challenges/$challengeId",
        params: {
          challengeId: n.id
        }
      });
    }, g = (n) => {
      o({
        to: "/challenges/$challengeId",
        params: {
          challengeId: n.id
        }
      });
    }, x = async () => {
      try {
        let n = 0;
        for (const s of ye) try {
          await _.challenges.add(s), n++;
        } catch (i) {
          console.error(`Failed to import preset ${s.name}:`, i);
        }
        n > 0 ? l.success(`\u6210\u529F\u5BFC\u5165 ${n} \u4E2A\u6311\u6218\u9884\u8BBE`) : l.error("\u6CA1\u6709\u627E\u5230\u53EF\u5BFC\u5165\u7684\u6311\u6218\u9884\u8BBE");
      } catch (n) {
        l.error("\u5BFC\u5165\u9884\u8BBE\u5931\u8D25"), console.error(n);
      }
    }, c = e.jsxs("div", {
      className: "flex items-center gap-2",
      children: [
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: () => d(true),
          children: [
            e.jsx(Y, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u6311\u6218"
          ]
        }),
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          onClick: x,
          children: [
            e.jsx(z, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u5165\u9884\u8BBE"
          ]
        }),
        e.jsxs(m, {
          variant: "outline",
          size: "sm",
          className: "hidden sm:flex items-center gap-2",
          type: "button",
          children: [
            e.jsx(I, {
              className: "w-4 h-4"
            }),
            "\u5BFC\u51FA\u6240\u6709"
          ]
        }),
        e.jsxs(m, {
          variant: "default",
          size: "sm",
          className: "flex items-center gap-2",
          onClick: () => o({
            to: "/create/challenge"
          }),
          type: "button",
          children: [
            e.jsx(Z, {
              className: "w-4 h-4"
            }),
            "\u65B0\u5EFA\u6311\u6218"
          ]
        }),
        e.jsx(ne, {
          open: r,
          onOpenChange: d,
          onImport: (n) => {
            l.success(`\u6210\u529F\u5BFC\u5165\u6311\u6218: ${n.name}`);
          }
        })
      ]
    });
    return e.jsxs("div", {
      className: "relative",
      children: [
        e.jsx(ae, {
          items: t,
          title: "\u6311\u6218\u5217\u8868",
          placeholder: "\u641C\u7D22\u540D\u79F0\u3001\u63CF\u8FF0\u6216\u6807\u7B7E...",
          actions: c,
          getSearchableContent: (n) => {
            var _a;
            return `${n.name} ${n.description} ${((_a = n.tags) == null ? void 0 : _a.join(" ")) || ""}`;
          },
          getTags: (n) => n.tags || [],
          getId: (n) => n.id,
          renderCard: (n) => e.jsx(Ne, {
            challenge: n,
            onClick: g,
            onStartSession: a
          })
        }),
        e.jsx("div", {
          className: "absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center cursor-not-allowed z-50",
          onClick: () => l.info("\u6311\u6218\u5361\u529F\u80FD\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85"),
          children: e.jsxs("div", {
            className: "text-center space-y-2",
            children: [
              e.jsx("p", {
                className: "text-lg font-semibold",
                children: "\u529F\u80FD\u6682\u672A\u5F00\u653E"
              }),
              e.jsx("p", {
                className: "text-sm text-muted-foreground",
                children: "\u6311\u6218\u5361\u5E7F\u573A\u529F\u80FD\u6B63\u5728\u5F00\u53D1\u4E2D"
              })
            ]
          })
        })
      ]
    });
  }
  const As = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ls
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Es() {
    const o = b(), r = async (t) => {
      if (!t.name) {
        l.error("\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A");
        return;
      }
      try {
        const a = Date.now(), x = {
          id: crypto.randomUUID(),
          name: t.name,
          description: t.description || "",
          personality: t.personality || "",
          scenario: t.scenario || "",
          first_mes: t.first_mes || "",
          mes_example: t.mes_example || "",
          creator_notes: t.creator_notes || "",
          system_prompt: t.system_prompt || "",
          post_history_instructions: t.post_history_instructions || "",
          alternate_greetings: t.alternate_greetings || [],
          tags: t.tags || [],
          extensions: t.extensions || {},
          assets: t.assets,
          avatar: t.avatar,
          imageBase64: t.imageBase64,
          character_book: t.character_book,
          nickname: t.nickname,
          source: t.source,
          creation_date: t.creation_date || a,
          modification_date: t.modification_date || a,
          creator: "User",
          character_version: "1.0",
          group_only_greetings: [],
          createdAt: a,
          updatedAt: a
        };
        await _.characters.add(x);
        const c = x;
        l.success(`\u89D2\u8272 ${c.name} \u5DF2\u521B\u5EFA`), o({
          to: "/plaza/characters"
        });
      } catch (a) {
        l.error("\u521B\u5EFA\u5931\u8D25"), console.error(a);
      }
    }, d = () => {
      o({
        to: "/create"
      });
    };
    return e.jsx("div", {
      className: "p-6 w-full max-w-5xl mx-auto",
      children: e.jsx(re, {
        className: "w-full",
        onSave: r,
        onCancel: d,
        mode: "create"
      })
    });
  }
  const Ms = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Es
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Vs() {
    return e.jsx("div", {
      className: "p-6 relative",
      children: e.jsx("div", {
        className: "absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center cursor-not-allowed",
        onClick: () => l.info("\u6311\u6218\u5361\u529F\u80FD\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85"),
        children: e.jsxs("div", {
          className: "text-center space-y-2",
          children: [
            e.jsx("p", {
              className: "text-lg font-semibold",
              children: "\u529F\u80FD\u6682\u672A\u5F00\u653E"
            }),
            e.jsx("p", {
              className: "text-sm text-muted-foreground",
              children: "\u6311\u6218\u5361\u521B\u5EFA\u529F\u80FD\u6B63\u5728\u5F00\u53D1\u4E2D"
            })
          ]
        })
      })
    });
  }
  const Fs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Vs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Us() {
    const o = f.useId(), r = f.useId(), d = f.useId(), t = f.useId(), [a, g] = f.useState({
      appName: "My App",
      enableNotifications: true,
      theme: "auto",
      description: ""
    }), x = () => {
      l.success("\u8BBE\u7F6E\u5DF2\u4FDD\u5B58");
    }, c = (n, s) => {
      g((i) => ({
        ...i,
        [n]: s
      }));
    };
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsx("h1", {
          className: "text-2xl font-bold",
          children: "\u5E94\u7528\u8BBE\u7F6E"
        }),
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u7BA1\u7406\u5E94\u7528\u7684\u57FA\u672C\u914D\u7F6E\u548C\u504F\u597D\u8BBE\u7F6E\u3002"
        }),
        e.jsxs(S, {
          children: [
            e.jsxs(P, {
              children: [
                e.jsx(O, {
                  children: "\u57FA\u672C\u8BBE\u7F6E"
                }),
                e.jsx(k, {
                  children: "\u914D\u7F6E\u5E94\u7528\u7684\u57FA\u672C\u4FE1\u606F\u548C\u884C\u4E3A\u3002"
                })
              ]
            }),
            e.jsxs(D, {
              className: "space-y-4",
              children: [
                e.jsxs("div", {
                  className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                  children: [
                    e.jsxs("div", {
                      className: "space-y-2",
                      children: [
                        e.jsx($, {
                          htmlFor: o,
                          children: "\u5E94\u7528\u540D\u79F0"
                        }),
                        e.jsx(W, {
                          id: o,
                          value: a.appName,
                          onChange: (n) => c("appName", n.target.value)
                        })
                      ]
                    }),
                    e.jsxs("div", {
                      className: "space-y-2",
                      children: [
                        e.jsx($, {
                          htmlFor: r,
                          children: "\u4E3B\u9898"
                        }),
                        e.jsx(W, {
                          id: r,
                          value: a.theme,
                          onChange: (n) => c("theme", n.target.value)
                        })
                      ]
                    })
                  ]
                }),
                e.jsxs("div", {
                  className: "space-y-2",
                  children: [
                    e.jsx($, {
                      htmlFor: d,
                      children: "\u63CF\u8FF0"
                    }),
                    e.jsx(ke, {
                      id: d,
                      value: a.description,
                      onChange: (n) => c("description", n.target.value),
                      placeholder: "\u8F93\u5165\u5E94\u7528\u63CF\u8FF0..."
                    })
                  ]
                }),
                e.jsxs("div", {
                  className: "flex items-center space-x-2",
                  children: [
                    e.jsx(De, {
                      id: t,
                      checked: a.enableNotifications,
                      onCheckedChange: (n) => c("enableNotifications", n)
                    }),
                    e.jsx($, {
                      htmlFor: t,
                      children: "\u542F\u7528\u901A\u77E5"
                    })
                  ]
                }),
                e.jsx(m, {
                  onClick: x,
                  children: "\u4FDD\u5B58\u8BBE\u7F6E"
                })
              ]
            })
          ]
        })
      ]
    });
  }
  const Bs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Us
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Gs() {
    const o = [
      {
        name: "LLM \u914D\u7F6E",
        path: "/config/llm",
        description: "\u7BA1\u7406 LLM \u6A21\u578B\u914D\u7F6E\u3001API \u5BC6\u94A5\u548C\u8C03\u7528\u53C2\u6570\u3002"
      }
    ];
    return e.jsxs("div", {
      className: "space-y-6",
      children: [
        e.jsx("h1", {
          className: "text-2xl font-bold",
          children: "\u914D\u7F6E\u7BA1\u7406\u6982\u89C8"
        }),
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u8FD9\u91CC\u60A8\u53EF\u4EE5\u7BA1\u7406\u672C\u5E94\u7528\u4E2D\u7684\u5404\u79CD\u914D\u7F6E\uFF0C\u5305\u62EC\u5E94\u7528\u8BBE\u7F6E\u3001\u7528\u6237\u504F\u597D\u548C\u7CFB\u7EDF\u53C2\u6570\u3002"
        }),
        e.jsx("div", {
          className: "grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",
          children: o.map((r) => e.jsxs(S, {
            className: "hover:shadow-md transition-shadow",
            children: [
              e.jsx(P, {
                children: e.jsx(O, {
                  className: "text-lg",
                  children: r.name
                })
              }),
              e.jsxs(D, {
                children: [
                  e.jsx(k, {
                    className: "mb-4",
                    children: r.description
                  }),
                  e.jsx(m, {
                    asChild: true,
                    children: e.jsx(N, {
                      to: r.path,
                      children: "\u67E5\u770B\u8BE6\u60C5"
                    })
                  })
                ]
              })
            ]
          }, r.path))
        })
      ]
    });
  }
  const Hs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Gs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Js() {
    const o = ls.useNavigate(), { config: r, setConfig: d, models: t, isFetchingModels: a, fetchModels: g, customParamList: x, addCustomParam: c, updateCustomParam: n, removeCustomParam: s } = Ge();
    return e.jsxs("div", {
      className: "container max-w-4xl mx-auto p-4 space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsx("h1", {
              className: "text-3xl font-bold",
              children: "\u5168\u5C40 LLM \u914D\u7F6E"
            }),
            e.jsx(m, {
              onClick: () => o({
                to: ".."
              }),
              children: "\u8FD4\u56DE"
            })
          ]
        }),
        e.jsx(Be, {
          config: r,
          setConfig: d,
          models: t,
          isFetchingModels: a,
          fetchModels: g,
          customParamList: x,
          addCustomParam: c,
          updateCustomParam: n,
          removeCustomParam: s
        })
      ]
    });
  }
  const Ws = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Js
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function qs() {
    const { characterId: o } = ds.useParams(), r = b(), { data: d = [] } = v((s) => s.from({
      c: w
    })), { data: t = [] } = v((s) => s.from({
      s: U
    })), a = d.find((s) => s.id === o), g = t.filter((s) => s.characterId === o);
    if (!a) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u89D2\u8272\u4E0D\u5B58\u5728"
        }),
        e.jsx(m, {
          onClick: () => r({
            to: "/plaza/characters"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const x = async (s) => {
      if (s === "challenge") {
        l.info("\u6311\u6218\u6A21\u5F0F\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85");
        return;
      }
      try {
        const i = crypto.randomUUID(), j = Date.now(), T = {
          id: i,
          title: s === "chat" ? `\u4E0E ${a.name} \u7684\u804A\u5929` : `\u6311\u6218: ${a.name}`,
          contextId: null,
          mode: s,
          modeConfig: {},
          modeState: {},
          characterId: a.id,
          challengeId: void 0,
          createdAt: j,
          updatedAt: j,
          isActive: true
        };
        await _.sessions.add(T), r({
          to: "/session/$sessionId",
          params: {
            sessionId: i
          },
          search: {
            mode: s
          }
        });
      } catch (i) {
        console.error("Failed to create session:", i), l.error("\u521B\u5EFA\u4F1A\u8BDD\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, c = () => {
      try {
        if (!a.imageBase64) {
          l.error("\u8BE5\u89D2\u8272\u6CA1\u6709\u5934\u50CF\u56FE\u7247\uFF0C\u65E0\u6CD5\u5BFC\u51FA\u4E3A PNG \u89D2\u8272\u5361");
          return;
        }
        const s = $e(a), i = URL.createObjectURL(s), j = document.createElement("a");
        j.href = i, j.download = `${a.name}.png`, j.click(), URL.revokeObjectURL(i), l.success(`\u89D2\u8272 ${a.name} \u5DF2\u5BFC\u51FA\u4E3A PNG \u89D2\u8272\u5361`);
      } catch (s) {
        console.error(s), l.error("\u5BFC\u51FA PNG \u89D2\u8272\u5361\u5931\u8D25");
      }
    }, n = async () => {
      try {
        const s = t.filter((i) => i.characterId === o);
        for (const i of s) await _.sessions.delete(i.id);
        await _.characters.delete(o), l.success("\u89D2\u8272\u5DF2\u5220\u9664"), r({
          to: "/plaza/characters"
        });
      } catch (s) {
        console.error("Failed to delete character:", s), l.error("\u5220\u9664\u89D2\u8272\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    };
    return e.jsxs("div", {
      className: "w-full max-w-5xl mx-auto p-4 md:p-8 space-y-8 animate-in fade-in duration-500",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs(m, {
              variant: "ghost",
              size: "sm",
              className: "mb-2 -ml-2 text-muted-foreground hover:bg-transparent",
              onClick: () => r({
                to: "/plaza/characters"
              }),
              type: "button",
              children: [
                e.jsx(F, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u8FD4\u56DE\u89D2\u8272\u5E7F\u573A"
              ]
            }),
            e.jsxs("div", {
              className: "flex items-center gap-2",
              children: [
                e.jsxs(L, {
                  children: [
                    e.jsx(A, {
                      asChild: true,
                      children: e.jsxs(m, {
                        variant: "outline",
                        size: "sm",
                        className: "flex gap-2 h-8 rounded-lg",
                        type: "button",
                        children: [
                          e.jsx(I, {
                            className: "w-4 h-4"
                          }),
                          "\u5BFC\u51FA"
                        ]
                      })
                    }),
                    e.jsxs(E, {
                      align: "end",
                      className: "w-56",
                      children: [
                        e.jsx(Re, {
                          children: "\u9009\u62E9\u5BFC\u51FA\u683C\u5F0F"
                        }),
                        e.jsx(q, {}),
                        e.jsxs(y, {
                          onClick: c,
                          children: [
                            e.jsx(ue, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5BFC\u51FA PNG \u89D2\u8272\u5361 (\u63A8\u8350)"
                          ]
                        }),
                        e.jsx(be, {
                          character: a,
                          trigger: e.jsxs(y, {
                            onSelect: (s) => s.preventDefault(),
                            children: [
                              e.jsx(xe, {
                                className: "mr-2 h-4 w-4"
                              }),
                              " \u5BFC\u51FA JSON \u539F\u59CB\u6570\u636E"
                            ]
                          })
                        })
                      ]
                    })
                  ]
                }),
                e.jsxs(L, {
                  children: [
                    e.jsx(A, {
                      asChild: true,
                      children: e.jsx(m, {
                        variant: "ghost",
                        size: "icon",
                        className: "h-8 w-8 rounded-full",
                        type: "button",
                        children: e.jsx(ee, {
                          className: "w-4 h-4"
                        })
                      })
                    }),
                    e.jsxs(E, {
                      align: "end",
                      className: "w-48",
                      children: [
                        e.jsxs(y, {
                          onClick: () => r({
                            to: "/characters/$characterId/edit",
                            params: {
                              characterId: a.id
                            }
                          }),
                          children: [
                            e.jsx(J, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u7F16\u8F91\u89D2\u8272"
                          ]
                        }),
                        e.jsxs(y, {
                          children: [
                            e.jsx(se, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5206\u4EAB\u89D2\u8272"
                          ]
                        }),
                        e.jsx(q, {}),
                        e.jsxs(ze, {
                          children: [
                            e.jsx(Te, {
                              asChild: true,
                              children: e.jsxs(y, {
                                onSelect: (s) => s.preventDefault(),
                                className: "text-destructive focus:bg-destructive/10 focus:text-destructive",
                                children: [
                                  e.jsx(te, {
                                    className: "mr-2 h-4 w-4"
                                  }),
                                  " \u5220\u9664\u89D2\u8272"
                                ]
                              })
                            }),
                            e.jsxs(Le, {
                              children: [
                                e.jsxs(Ae, {
                                  children: [
                                    e.jsx(Ee, {
                                      children: "\u786E\u8BA4\u5220\u9664\u89D2\u8272"
                                    }),
                                    e.jsxs(Me, {
                                      children: [
                                        '\u786E\u5B9A\u8981\u5220\u9664\u89D2\u8272 "',
                                        a.name,
                                        '" \u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\uFF0C\u4E14\u4F1A\u6E05\u9664\u6240\u6709\u5173\u8054\u7684\u4F1A\u8BDD\u8BB0\u5F55\u3002'
                                      ]
                                    })
                                  ]
                                }),
                                e.jsxs(Ve, {
                                  children: [
                                    e.jsx(Fe, {
                                      children: "\u53D6\u6D88"
                                    }),
                                    e.jsx(Ue, {
                                      onClick: n,
                                      className: "bg-destructive hover:bg-destructive/90",
                                      children: "\u786E\u8BA4\u5220\u9664"
                                    })
                                  ]
                                })
                              ]
                            })
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs("div", {
          className: "flex flex-col md:flex-row gap-8 items-start pb-8 border-b",
          children: [
            e.jsx("div", {
              className: "w-40 h-40 rounded-3xl bg-muted flex items-center justify-center shrink-0 border-4 border-background shadow-xl overflow-hidden",
              children: a.imageBase64 || a.avatar ? e.jsx("img", {
                src: a.imageBase64 || a.avatar,
                alt: a.name,
                className: "w-full h-full object-cover"
              }) : e.jsx(ge, {
                className: "w-20 h-20 text-muted-foreground/30"
              })
            }),
            e.jsxs("div", {
              className: "space-y-5 grow",
              children: [
                e.jsxs("div", {
                  className: "space-y-1",
                  children: [
                    e.jsxs("div", {
                      className: "flex items-center gap-3",
                      children: [
                        e.jsx("h1", {
                          className: "text-4xl font-extrabold tracking-tight",
                          children: a.name
                        }),
                        e.jsxs(m, {
                          variant: "outline",
                          size: "sm",
                          onClick: () => r({
                            to: "/characters/$characterId/edit",
                            params: {
                              characterId: a.id
                            }
                          }),
                          className: "flex items-center gap-2",
                          type: "button",
                          children: [
                            e.jsx(J, {
                              className: "w-4 h-4"
                            }),
                            "\u7F16\u8F91"
                          ]
                        })
                      ]
                    }),
                    e.jsx("p", {
                      className: "text-xl text-muted-foreground font-medium",
                      children: a.nickname || a.name
                    })
                  ]
                }),
                e.jsx("div", {
                  className: "flex flex-wrap gap-2",
                  children: a.tags.map((s) => e.jsx(M, {
                    variant: "secondary",
                    className: "px-3 py-1 font-medium",
                    children: s
                  }, s))
                }),
                e.jsxs("p", {
                  className: "text-base leading-relaxed text-muted-foreground/90 max-w-2xl",
                  children: [
                    a.description.slice(0, 200),
                    a.description.length > 200 ? "..." : ""
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs(B, {
          defaultValue: "sessions",
          className: "w-full",
          children: [
            e.jsxs(G, {
              className: "w-full justify-start h-12 bg-muted/50 p-1 mb-6",
              children: [
                e.jsx(C, {
                  value: "sessions",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u4F1A\u8BDD & \u8BB0\u5F55"
                }),
                e.jsx(C, {
                  value: "details",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u6863\u6848\u8BE6\u60C5"
                })
              ]
            }),
            e.jsx(V, {
              value: "sessions",
              className: "mt-0",
              children: e.jsx("div", {
                className: "grid grid-cols-1 md:grid-cols-1 gap-8",
                children: e.jsx(Ce, {
                  characterId: a.id,
                  sessions: g,
                  onStartNew: x
                })
              })
            }),
            e.jsx(V, {
              value: "details",
              className: "mt-0",
              children: e.jsx(we, {
                character: a
              })
            })
          ]
        })
      ]
    });
  }
  const Qs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: qs
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ks() {
    var _a;
    const { challengeId: o } = hs.useParams(), r = b(), { data: d = [] } = v((s) => s.from({
      c: oe
    })), t = d.find((s) => s.id === o), { data: a = [] } = v((s) => s.from({
      s: U
    })), { data: g = [] } = v((s) => s.from({
      char: w
    })), x = a.filter((s) => s.challengeId === o);
    if (!t) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u6311\u6218\u4E0D\u5B58\u5728"
        }),
        e.jsx(m, {
          onClick: () => r({
            to: "/plaza/challenges"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const c = async (s) => {
      try {
        const i = crypto.randomUUID(), j = Date.now(), T = {
          id: i,
          title: `\u6311\u6218: ${t.name}`,
          contextId: null,
          mode: "challenge",
          modeConfig: {},
          modeState: {},
          characterId: s,
          challengeId: t.id,
          createdAt: j,
          updatedAt: j,
          isActive: true
        };
        await _.sessions.add(T), r({
          to: "/session/$sessionId",
          params: {
            sessionId: i
          },
          search: {
            mode: "challenge"
          }
        });
      } catch (i) {
        console.error("Failed to create challenge session:", i), l.error("\u521B\u5EFA\u4F1A\u8BDD\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, n = () => {
      l.success(`\u6B63\u5728\u5BFC\u51FA\u6311\u6218 ${t.name}...`);
    };
    return e.jsxs("div", {
      className: "max-w-5xl mx-auto p-4 md:p-8 space-y-8 animate-in fade-in slide-in-from-bottom-2 duration-500 relative",
      children: [
        e.jsxs("div", {
          className: "flex items-center justify-between",
          children: [
            e.jsxs(m, {
              variant: "ghost",
              size: "sm",
              className: "mb-2 -ml-2 text-muted-foreground hover:bg-transparent",
              onClick: () => r({
                to: "/plaza/challenges"
              }),
              type: "button",
              children: [
                e.jsx(F, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u8FD4\u56DE\u6311\u6218\u5E7F\u573A"
              ]
            }),
            e.jsxs("div", {
              className: "flex items-center gap-2",
              children: [
                e.jsxs(m, {
                  variant: "outline",
                  size: "sm",
                  className: "hidden sm:flex gap-2 h-8 rounded-lg",
                  onClick: n,
                  type: "button",
                  children: [
                    e.jsx(I, {
                      className: "w-4 h-4"
                    }),
                    "\u5BFC\u51FA\u6311\u6218"
                  ]
                }),
                e.jsxs(L, {
                  children: [
                    e.jsx(A, {
                      asChild: true,
                      children: e.jsx(m, {
                        variant: "ghost",
                        size: "icon",
                        className: "h-8 w-8 rounded-full",
                        type: "button",
                        children: e.jsx(ee, {
                          className: "w-4 h-4"
                        })
                      })
                    }),
                    e.jsxs(E, {
                      align: "end",
                      className: "w-48",
                      children: [
                        e.jsxs(y, {
                          onClick: n,
                          className: "sm:hidden",
                          children: [
                            e.jsx(I, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5BFC\u51FA JSON"
                          ]
                        }),
                        e.jsxs(y, {
                          children: [
                            e.jsx(se, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5206\u4EAB\u6311\u6218"
                          ]
                        }),
                        e.jsxs(y, {
                          className: "text-destructive focus:bg-destructive/10 focus:text-destructive",
                          children: [
                            e.jsx(te, {
                              className: "mr-2 h-4 w-4"
                            }),
                            " \u5220\u9664\u6311\u6218"
                          ]
                        })
                      ]
                    })
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs("div", {
          className: "flex flex-col md:flex-row gap-8 items-start pb-8 border-b",
          children: [
            e.jsx("div", {
              className: "w-40 h-40 rounded-3xl bg-primary/10 flex items-center justify-center shrink-0 border-4 border-background shadow-xl overflow-hidden",
              children: e.jsx(X, {
                className: "w-20 h-20 text-primary"
              })
            }),
            e.jsxs("div", {
              className: "space-y-4 grow",
              children: [
                e.jsxs("div", {
                  className: "space-y-2",
                  children: [
                    e.jsx(M, {
                      variant: "outline",
                      className: "text-primary bg-primary/5 border-primary/20 uppercase tracking-widest text-[10px] px-2",
                      children: "Challenge Scenario"
                    }),
                    e.jsx("h1", {
                      className: "text-4xl font-extrabold tracking-tight",
                      children: t.name
                    })
                  ]
                }),
                e.jsx("div", {
                  className: "flex flex-wrap gap-2",
                  children: (_a = t.tags) == null ? void 0 : _a.map((s) => e.jsx(M, {
                    variant: "secondary",
                    className: "px-3 py-1 font-medium",
                    children: s
                  }, s))
                }),
                e.jsxs("p", {
                  className: "text-lg leading-relaxed text-muted-foreground italic font-serif",
                  children: [
                    '" ',
                    t.description.slice(0, 150),
                    '... "'
                  ]
                })
              ]
            })
          ]
        }),
        e.jsxs(B, {
          defaultValue: "details",
          className: "w-full",
          children: [
            e.jsxs(G, {
              className: "w-full justify-start h-12 bg-muted/50 p-1 mb-6",
              children: [
                e.jsx(C, {
                  value: "details",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u6311\u6218\u8BE6\u60C5"
                }),
                e.jsx(C, {
                  value: "sessions",
                  className: "px-8 h-10 data-[state=active]:shadow-sm",
                  children: "\u5173\u8054\u4F1A\u8BDD"
                })
              ]
            }),
            e.jsx(V, {
              value: "sessions",
              className: "mt-0",
              children: e.jsx(Ie, {
                challengeId: t.id,
                sessions: x,
                characters: g,
                onStartNew: c
              })
            })
          ]
        }),
        e.jsx("div", {
          className: "absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center cursor-not-allowed z-50",
          onClick: () => l.info("\u6311\u6218\u5361\u529F\u80FD\u6682\u672A\u5F00\u653E\uFF0C\u656C\u8BF7\u671F\u5F85"),
          children: e.jsxs("div", {
            className: "text-center space-y-2",
            children: [
              e.jsx("p", {
                className: "text-lg font-semibold",
                children: "\u529F\u80FD\u6682\u672A\u5F00\u653E"
              }),
              e.jsx("p", {
                className: "text-sm text-muted-foreground",
                children: "\u6311\u6218\u5361\u8BE6\u60C5\u529F\u80FD\u6B63\u5728\u5F00\u53D1\u4E2D"
              })
            ]
          })
        })
      ]
    });
  }
  const Xs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ks
  }, Symbol.toStringTag, {
    value: "Module"
  }));
  function Ys() {
    const { characterId: o } = us.useParams(), r = b(), { data: d = [] } = v((c) => c.from({
      c: w
    })), t = d.find((c) => c.id === o);
    if (!t) return e.jsxs("div", {
      className: "p-20 text-center flex flex-col items-center gap-4",
      children: [
        e.jsx("p", {
          className: "text-muted-foreground",
          children: "\u89D2\u8272\u4E0D\u5B58\u5728"
        }),
        e.jsx(m, {
          onClick: () => r({
            to: "/plaza/characters"
          }),
          variant: "outline",
          type: "button",
          children: "\u8FD4\u56DE\u5217\u8868"
        })
      ]
    });
    const a = async (c) => {
      try {
        const n = Date.now(), s = {
          ...t,
          ...c,
          updatedAt: n,
          modification_date: n
        };
        await _.characters.put(s), l.success(`\u89D2\u8272 ${t.name} \u5DF2\u66F4\u65B0`), r({
          to: "/characters/$characterId",
          params: {
            characterId: t.id
          }
        });
      } catch (n) {
        console.error("Failed to update character:", n), l.error("\u66F4\u65B0\u89D2\u8272\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");
      }
    }, g = () => {
      r({
        to: "/characters/$characterId",
        params: {
          characterId: t.id
        }
      });
    }, x = t;
    return e.jsxs("div", {
      className: "w-full max-w-5xl mx-auto p-4 md:p-8 space-y-6",
      children: [
        e.jsxs("div", {
          className: "flex items-center gap-2",
          children: [
            e.jsxs(m, {
              variant: "ghost",
              size: "sm",
              className: "text-muted-foreground hover:bg-transparent",
              onClick: g,
              type: "button",
              children: [
                e.jsx(F, {
                  className: "w-4 h-4 mr-1"
                }),
                " \u53D6\u6D88\u7F16\u8F91"
              ]
            }),
            e.jsxs("h1", {
              className: "text-xl font-bold",
              children: [
                "\u7F16\u8F91\u89D2\u8272: ",
                t.name
              ]
            })
          ]
        }),
        e.jsx(re, {
          onSave: a,
          onCancel: g,
          initialData: x,
          mode: "edit"
        })
      ]
    });
  }
  const Zs = Object.freeze(Object.defineProperty({
    __proto__: null,
    component: Ys
  }, Symbol.toStringTag, {
    value: "Module"
  }));
})();
export {
  lt as R,
  __tla,
  it as a,
  dt as b,
  mt as c,
  ht as d,
  pt as e,
  ut as f,
  xt as g,
  gt as h,
  es as i,
  jt as j,
  ft as k,
  vt as l,
  _t as m,
  Nt as n,
  yt as o,
  ls as p,
  ds as q,
  hs as r,
  us as s
};
